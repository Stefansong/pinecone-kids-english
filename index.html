<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¼å„¿è‹±è¯­å£è¯­300å¥ - äº’åŠ¨å­¦ä¹ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            .container {
                padding: 0.5rem;
            }
        }
        
        /* å¡ç‰‡åŠ¨ç”»å’Œäº¤äº’ */
        .phrase-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
            will-change: transform, box-shadow;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .phrase-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .phrase-card:hover::before {
            left: 100%;
        }
        
        .phrase-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .phrase-card:active {
            transform: translateY(-4px) scale(1.01);
            transition: all 0.1s ease;
        }
        
        /* ä¸»å¯¼èˆªæŒ‰é’®æ ·å¼ */
        .main-nav-button {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            color: #475569;
            border: 3px solid #cbd5e1;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 140px;
            min-height: 60px;
        }
        
        .main-nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transition: left 0.6s;
        }
        
        .main-nav-button:hover::before {
            left: 100%;
        }
        
        .main-nav-button:hover:not(.active) {
            background: linear-gradient(135deg, #e2e8f0, #cbd5e1);
            border-color: #94a3b8;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
            transform: translateY(-3px) scale(1.02);
        }
        
        .main-nav-button.active {
            color: white;
            transform: translateY(-2px);
        }
        
        /* åˆ†ç±»æµè§ˆæŒ‰é’® */
        #category-browse-button.active {
            background: linear-gradient(135deg, #10b981, #059669);
            border-color: #047857;
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }
        
        #category-browse-button:hover:not(.active) {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border-color: #6ee7b7;
        }
        
        /* å­¦ä¹ ä¸­å¿ƒæŒ‰é’® */
        #learning-hub-button.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-color: #1e40af;
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.4);
        }
        
        #learning-hub-button:hover:not(.active) {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-color: #93c5fd;
        }
        
        /* æŠ½è®¤å¡æŒ‰é’® */
        #flashcard-mode-button.active {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-color: #b45309;
            box-shadow: 0 15px 40px rgba(245, 158, 11, 0.4);
        }
        
        #flashcard-mode-button:hover:not(.active) {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-color: #fbbf24;
        }
        
        /* åˆ†ç±»æµè§ˆæŒ‰é’®å‘å…‰è¾¹æ¡† */
        #category-browse-button.active::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #10b981, #34d399, #6ee7b7, #a7f3d0);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
        }
        
        /* å­¦ä¹ ä¸­å¿ƒæŒ‰é’®å‘å…‰è¾¹æ¡† */
        #learning-hub-button.active::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #3b82f6, #60a5fa, #93c5fd, #bfdbfe);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
        }
        
        /* æŠ½è®¤å¡æŒ‰é’®å‘å…‰è¾¹æ¡† */
        #flashcard-mode-button.active::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #f59e0b, #fbbf24, #fcd34d, #fde68a);
            border-radius: inherit;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
        }
        
        @keyframes borderGlow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        /* ä¸»å¯¼èˆªæŒ‰é’®æ¿€æ´»çŠ¶æ€è„‰å†²åŠ¨ç”» */
        .main-nav-button.active {
            animation: activePulse 2s ease-in-out infinite;
        }
        
        @keyframes activePulse {
            0%, 100% { 
                box-shadow: 0 15px 40px rgba(59, 130, 246, 0.4);
            }
            50% { 
                box-shadow: 0 20px 50px rgba(59, 130, 246, 0.6);
            }
        }
        
        /* ä¸ºæ¯ä¸ªæŒ‰é’®å®šåˆ¶è„‰å†²é¢œè‰² */
        #category-browse-button.active {
            animation: categoryPulse 2s ease-in-out infinite;
        }
        
        @keyframes categoryPulse {
            0%, 100% { 
                box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
            }
            50% { 
                box-shadow: 0 20px 50px rgba(16, 185, 129, 0.6);
            }
        }
        
        #flashcard-mode-button.active {
            animation: flashcardPulse 2s ease-in-out infinite;
        }
        
        @keyframes flashcardPulse {
            0%, 100% { 
                box-shadow: 0 15px 40px rgba(245, 158, 11, 0.4);
            }
            50% { 
                box-shadow: 0 20px 50px rgba(245, 158, 11, 0.6);
            }
        }
        
        /* ç§»åŠ¨ç«¯ä¸»å¯¼èˆªæŒ‰é’®ä¼˜åŒ– */
        @media (max-width: 768px) {
            .main-nav-button {
                min-width: 120px;
                min-height: 50px;
                font-size: 0.9rem;
                padding: 12px 20px !important;
            }
            
            .main-nav-button:active {
                transform: scale(0.95);
                transition: transform 0.1s ease;
            }
        }
        
        /* æ¬¡çº§å¯¼èˆªæŒ‰é’®æ ·å¼ */
        .nav-button, .sub-nav-button, .action-button {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
        }
        
        .nav-button::before, .sub-nav-button::before, .action-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }
        
        .nav-button:active::before, .sub-nav-button:active::before, .action-button:active::before {
            width: 300px;
            height: 300px;
        }
        
        .nav-button.active {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(14, 165, 233, 0.4);
        }
        
        .nav-button {
            background: linear-gradient(135deg, #bae6fd, #93c5fd);
            color: #0369a1;
            border: 2px solid transparent;
        }
        
        .nav-button:hover:not(.active) {
            background: linear-gradient(135deg, #7dd3fc, #60a5fa);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(125, 211, 252, 0.4);
        }
        
        .action-button {
            background: linear-gradient(135deg, #14b8a6, #0d9488);
            color: white;
            border: 2px solid transparent;
            box-shadow: 0 4px 15px rgba(20, 184, 166, 0.3);
        }
        
        .action-button:hover {
            background: linear-gradient(135deg, #0d9488, #0f766e);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(13, 148, 136, 0.4);
        }
        
        .action-button:active {
            transform: translateY(0);
        }
        
        .sub-nav-button.active {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(14, 165, 233, 0.4);
        }
        
        .sub-nav-button {
            background: linear-gradient(135deg, #bae6fd, #93c5fd);
            color: #0369a1;
        }
        
        .sub-nav-button:hover:not(.active) {
            background: linear-gradient(135deg, #7dd3fc, #60a5fa);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(125, 211, 252, 0.4);
        }
        
        /* é—ªå¡å¢å¼ºåŠ¨ç”» */
        .flashcard {
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .flashcard:hover {
            transform: scale(1.05);
        }
        
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }
        
        .flashcard-front {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
        }
        
        .flashcard-back {
            background: linear-gradient(135deg, #a7f3d0, #6ee7b7);
            transform: rotateY(180deg);
        }
        
        /* éŸ³é¢‘æ’­æ”¾åŠ¨ç”»å¢å¼º */
        .speaker-icon.playing {
            animation: pulse 1s infinite;
        }
        
        .speaker-icon.playing path {
            animation: soundwave 0.8s infinite ease-in-out;
        }
        
        @keyframes soundwave {
            0%, 100% { 
                transform: scaleY(0.5); 
                transform-origin: bottom; 
                opacity: 0.7;
            }
            50% { 
                transform: scaleY(1.2); 
                transform-origin: bottom; 
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* è¿›åº¦æ¡åŠ¨ç”» */
        .progress-bar-fill {
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(90deg, #14b8a6, #06b6d4, #3b82f6);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* é¡µé¢åˆ‡æ¢åŠ¨ç”» */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .slide-in-right {
            animation: slideInRight 0.5s ease-out;
        }
        
        .slide-in-left {
            animation: slideInLeft 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* ç§»åŠ¨ç«¯è§¦æ‘¸åé¦ˆ */
        @media (max-width: 768px) {
            .phrase-card:active {
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }
            
            .nav-button:active, .action-button:active, .sub-nav-button:active {
                transform: scale(0.95);
                transition: transform 0.1s ease;
            }
            
            /* å¢å¤§è§¦æ‘¸ç›®æ ‡ */
            .pronounce-button, .toggle-translation-button, .mark-learned-button {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #14b8a6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* æˆåŠŸæç¤ºåŠ¨ç”» */
        .success-indicator {
            animation: successPulse 0.6s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* é”™è¯¯æç¤ºåŠ¨ç”» */
        .error-shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* æµ®åŠ¨åŠ¨ç”» */
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        /* æ¸å˜èƒŒæ™¯åŠ¨ç”» */
        .animated-background {
            background: linear-gradient(-45deg, #fffbeb, #fef3c7, #fde68a, #fed7aa);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* å­¦ä¹ è¿›åº¦æŒ‡ç¤ºå™¨ */
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dasharray 0.5s ease-in-out;
        }
        
        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        /* å“åº”å¼å­—ä½“å¤§å° */
        @media (max-width: 640px) {
            .text-3xl { font-size: 1.5rem; }
            .text-4xl { font-size: 1.875rem; }
            .text-xl { font-size: 1.125rem; }
            .text-2xl { font-size: 1.25rem; }
        }
        
        /* å­¦ä¹ æ¨¡å¼é€‰æ‹©æ ·å¼ */
        .learning-mode-option input:checked + div {
            border-color: #3b82f6 !important;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe) !important;
        }
        
        /* ç›®æ ‡è¿›åº¦æ¡åŠ¨ç”» */
        .goal-progress-bar {
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* æ´å¯Ÿå¡ç‰‡æ‚¬åœæ•ˆæœ */
        .insight-card {
            transition: all 0.3s ease;
        }
        
        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* æ™ºèƒ½è§„åˆ’å¯¹è¯æ¡†åŠ¨ç”» */
        .smart-plan-dialog {
            animation: fadeInScale 0.3s ease-out;
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* ç›®æ ‡å®Œæˆåº†ç¥åŠ¨ç”» */
        .goal-celebration {
            animation: goalCelebration 0.6s ease-out;
        }
        
        @keyframes goalCelebration {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* å­¦ä¹ ç»Ÿè®¡å¡ç‰‡ */
        .stats-card {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            transform: translateY(-1px);
        }
    </style>
</head>
<body class="min-h-screen text-stone-700 p-4 sm:p-6 md:p-8">
    <div class="container mx-auto max-w-5xl">
        <header class="text-center mb-8 fade-in">
            <h1 class="text-3xl sm:text-4xl font-bold text-sky-600 float-animation">
                ğŸŒ² æ¾æœå¹¼å„¿è‹±è¯­å£è¯­300å¥
            </h1>
            <p class="text-lg text-stone-600 mt-2">âœ¨ äº’åŠ¨å­¦ä¹ åº”ç”¨ âœ¨</p>
            <div class="mt-4 flex justify-center">
                <div class="bg-gradient-to-r from-sky-400 to-teal-400 h-1 w-24 rounded-full"></div>
            </div>
        </header>

                <nav class="mb-8 slide-in-right">
            <div class="flex flex-wrap justify-center gap-3 sm:gap-4 mb-6 p-4 bg-gradient-to-r from-white/90 to-blue-50/90 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/40">
                <button id="category-browse-button" class="main-nav-button py-4 px-8 rounded-2xl text-base sm:text-lg font-semibold active tooltip transform hover:scale-105 transition-all duration-300" data-tooltip="æŒ‰ä¸»é¢˜æµè§ˆå­¦ä¹ ">
                    <span class="inline-block transform transition-transform duration-300 hover:rotate-12">ğŸ“š</span> åˆ†ç±»æµè§ˆ
                </button>
                <button id="learning-hub-button" class="main-nav-button py-4 px-8 rounded-2xl text-base sm:text-lg font-semibold tooltip transform hover:scale-105 transition-all duration-300" data-tooltip="åˆ¶å®šå­¦ä¹ è®¡åˆ’">
                    <span class="inline-block transform transition-transform duration-300 hover:scale-125">ğŸ¯</span> å­¦ä¹ ä¸­å¿ƒ
                </button>
                <button id="flashcard-mode-button" class="main-nav-button py-4 px-8 rounded-2xl text-base sm:text-lg font-semibold tooltip transform hover:scale-105 transition-all duration-300" data-tooltip="å¡ç‰‡å¼å­¦ä¹ ">
                    <span class="inline-block transform transition-transform duration-300 hover:rotate-180">ğŸƒ</span> æŠ½è®¤å¡æ¨¡å¼
                </button>
            </div>
            <div id="category-buttons" class="flex flex-wrap justify-center gap-2 sm:gap-3">
                </div>
        </nav>

        <main id="content-area">
            <p id="category-intro" class="text-center text-stone-600 mb-6 text-lg"></p>

            <div id="phrases-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
            </div>

            <div id="flashcard-container" class="hidden">
                <div class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-6 p-4 bg-white rounded-lg shadow-md">
                    <span class="text-stone-700 text-sm sm:text-base font-medium">å¡ç‰‡æ¥æº:</span>
                    <label class="inline-flex items-center">
                        <input type="radio" name="flashcard-source" value="all" class="form-radio text-teal-500" checked>
                        <span class="ml-2 text-stone-600">æ‰€æœ‰çŸ­è¯­</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="flashcard-source" value="category" class="form-radio text-teal-500">
                        <span class="ml-2 text-stone-600">å½“å‰åˆ†ç±»</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="flashcard-source" value="unlearned" class="form-radio text-teal-500">
                        <span class="ml-2 text-stone-600">æœªæŒæ¡çŸ­è¯­</span>
                    </label>
                    <button id="shuffle-flashcards-button" class="action-button py-1 px-3 rounded-md text-sm">ğŸ”€ é‡æ–°æ´—ç‰Œ</button>
                </div>

                <div id="flashcard-display-area">
                    </div>
                
                <div class="flex flex-col items-center mt-6 gap-4">
                    <p id="flashcard-counter" class="text-stone-600 text-base sm:text-lg"></p>
                    <div id="flashcard-nav-buttons" class="flex justify-between gap-4 w-full max-w-md">
                        <button id="prev-flashcard" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base flex-1">ä¸Šä¸€å¼ </button>
                        <button id="mark-learned-flashcard-button" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base bg-sky-600 hover:bg-sky-700 flex-1">æ ‡è®°å·²å­¦</button>
                        <button id="next-flashcard" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base flex-1">ä¸‹ä¸€å¼ </button>
                    </div>
                </div>
            </div>

            <div id="learning-hub-container" class="hidden p-4 sm:p-6 bg-white rounded-lg shadow-md">
                <div class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-6">
                    <button id="learning-plan-tab-button" class="sub-nav-button py-2 px-4 rounded-lg text-sm sm:text-base font-medium active tooltip" data-tooltip="æ™ºèƒ½å­¦ä¹ è®¡åˆ’">ğŸ“š å­¦ä¹ è®¡åˆ’</button>
                    <button id="review-plan-tab-button" class="sub-nav-button py-2 px-4 rounded-lg text-sm sm:text-base font-medium tooltip" data-tooltip="ç§‘å­¦å¤ä¹ å®‰æ’">ğŸ”„ å¤ä¹ è®¡åˆ’</button>
                    <button id="my-progress-tab-button" class="sub-nav-button py-2 px-4 rounded-lg text-sm sm:text-base font-medium tooltip" data-tooltip="è¯¦ç»†å­¦ä¹ ç»Ÿè®¡">ğŸ“Š æˆ‘çš„è¿›åº¦</button>
                    <button id="learning-goals-tab-button" class="sub-nav-button py-2 px-4 rounded-lg text-sm sm:text-base font-medium tooltip" data-tooltip="è®¾å®šå­¦ä¹ ç›®æ ‡">ğŸ¯ å­¦ä¹ ç›®æ ‡</button>
                    <button id="learning-insights-tab-button" class="sub-nav-button py-2 px-4 rounded-lg text-sm sm:text-base font-medium tooltip" data-tooltip="å­¦ä¹ æ´å¯Ÿåˆ†æ">ğŸ’¡ å­¦ä¹ æ´å¯Ÿ</button>
                </div>

                <div id="learning-plan-content" class="learning-hub-content">
                    <h2 class="text-xl sm:text-2xl font-bold text-sky-600 mb-4 text-center">ğŸ“š æ™ºèƒ½å­¦ä¹ è®¡åˆ’</h2>
                    <p class="text-center text-stone-600 mb-6 text-base">åŸºäºæ‚¨çš„å­¦ä¹ èƒ½åŠ›å’Œè¿›åº¦ï¼Œä¸ºæ‚¨é‡èº«å®šåˆ¶çš„å­¦ä¹ è®¡åˆ’</p>
                    
                    <!-- å­¦ä¹ æ¨¡å¼é€‰æ‹© -->
                    <div class="bg-gradient-to-r from-blue-50 to-teal-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-teal-700 mb-3">ğŸ¯ å­¦ä¹ æ¨¡å¼</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                            <label class="learning-mode-option cursor-pointer">
                                <input type="radio" name="learning-mode" value="beginner" class="sr-only">
                                <div class="p-3 border-2 border-stone-200 rounded-lg text-center hover:border-blue-400 transition-colors">
                                    <div class="text-2xl mb-1">ğŸ£</div>
                                    <div class="font-medium">åˆå­¦è€…æ¨¡å¼</div>
                                    <div class="text-xs text-stone-600">æ¯å¤©2-3ä¸ªçŸ­è¯­</div>
                                </div>
                            </label>
                            <label class="learning-mode-option cursor-pointer">
                                <input type="radio" name="learning-mode" value="normal" class="sr-only" checked>
                                <div class="p-3 border-2 border-blue-400 bg-blue-50 rounded-lg text-center transition-colors">
                                    <div class="text-2xl mb-1">ğŸŒ±</div>
                                    <div class="font-medium">æ ‡å‡†æ¨¡å¼</div>
                                    <div class="text-xs text-stone-600">æ¯å¤©3-5ä¸ªçŸ­è¯­</div>
                                </div>
                            </label>
                            <label class="learning-mode-option cursor-pointer">
                                <input type="radio" name="learning-mode" value="intensive" class="sr-only">
                                <div class="p-3 border-2 border-stone-200 rounded-lg text-center hover:border-blue-400 transition-colors">
                                    <div class="text-2xl mb-1">ğŸš€</div>
                                    <div class="font-medium">å¼ºåŒ–æ¨¡å¼</div>
                                    <div class="text-xs text-stone-600">æ¯å¤©5-8ä¸ªçŸ­è¯­</div>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <!-- ä»Šæ—¥å­¦ä¹ ä»»åŠ¡ -->
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-emerald-700 mb-3">ğŸ“… ä»Šæ—¥å­¦ä¹ ä»»åŠ¡</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-blue-600" id="today-target">5</div>
                                <div class="text-xs text-stone-600">ç›®æ ‡çŸ­è¯­</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-green-600" id="today-completed">0</div>
                                <div class="text-xs text-stone-600">å·²å®Œæˆ</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-orange-600" id="today-review">2</div>
                                <div class="text-xs text-stone-600">éœ€å¤ä¹ </div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-purple-600" id="study-streak">0</div>
                                <div class="text-xs text-stone-600">è¿ç»­å¤©æ•°</div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex justify-between text-sm text-stone-600 mb-1">
                                <span>ä»Šæ—¥è¿›åº¦</span>
                                <span id="today-progress-text">0%</span>
                            </div>
                            <div class="w-full bg-stone-200 rounded-full h-3">
                                <div id="today-progress-bar" class="bg-gradient-to-r from-green-400 to-emerald-500 h-full rounded-full transition-all duration-500" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å­¦ä¹ è®¡åˆ’æ§åˆ¶ -->
                    <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-6">
                        <div class="flex items-center gap-2">
                            <label for="phrases-per-day-input" class="text-stone-600 text-sm sm:text-base">è‡ªå®šä¹‰æ¯æ—¥å¥æ•°:</label>
                            <input type="number" id="phrases-per-day-input" value="3" min="1" max="15" class="w-20 p-2 border border-stone-300 rounded-md text-center text-sm sm:text-base">
                        </div>
                        <div class="flex items-center gap-4">
                            <button id="prev-day-button" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base">â¬…ï¸ ä¸Šä¸€å¤©</button>
                            <span id="current-day-display" class="text-lg sm:text-xl font-semibold text-teal-700"></span>
                            <button id="next-day-button" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base">ä¸‹ä¸€å¤© â¡ï¸</button>
                        </div>
                        <button id="auto-plan-button" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base bg-purple-600 hover:bg-purple-700">ğŸ¤– æ™ºèƒ½è§„åˆ’</button>
                    </div>
                    
                    <div id="daily-phrases-display" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                    </div>
                </div>

                <div id="review-plan-content" class="learning-hub-content hidden">
                    <h2 class="text-xl sm:text-2xl font-bold text-sky-600 mb-4 text-center">æˆ‘çš„å¤ä¹ è®¡åˆ’</h2>
                    <p class="text-center text-stone-600 mb-6 text-base">è¿™é‡Œä¼šæ˜¾ç¤ºæ‚¨å°šæœªæŒæ¡çš„çŸ­è¯­ï¼Œå¸®åŠ©æ‚¨æ¸©æ•…çŸ¥æ–°ã€‚</p>
                    <div id="review-phrases-display" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                        </div>
                    <div class="flex justify-center mt-6">
                        <button id="refresh-review-button" class="action-button py-2 px-4 rounded-lg text-sm sm:text-base">åˆ·æ–°å¤ä¹ çŸ­è¯­</button>
                    </div>
                </div>

                <div id="my-progress-content" class="learning-hub-content hidden">
                    <h2 class="text-xl sm:text-2xl font-bold text-sky-600 mb-4 text-center">ğŸ“Š æˆ‘çš„å­¦ä¹ è¿›åº¦</h2>
                    <p class="text-center text-stone-600 mb-6 text-base">æŸ¥çœ‹æ‚¨çš„æ•´ä½“å­¦ä¹ è¿›å±•å’Œè¯¦ç»†ç»Ÿè®¡ã€‚</p>
                    <div class="flex flex-col items-center mb-6">
                        <p class="text-lg font-semibold text-stone-700 mb-2">æ€»çŸ­è¯­æ•°: <span id="total-phrases-count"></span> å¥</p>
                        <p class="text-lg font-semibold text-stone-700 mb-2">å·²å­¦çŸ­è¯­æ•°: <span id="learned-phrases-count"></span> å¥</p>
                        <p class="text-2xl font-bold text-teal-600 mb-4"><span id="progress-percentage"></span>%</p>
                        <div class="w-full max-w-md bg-stone-200 rounded-full h-4">
                            <div id="progress-bar-fill" class="bg-teal-500 h-full rounded-full progress-bar-fill" style="width: 0%;"></div>
                        </div>
                    </div>
                    <h3 class="text-lg sm:text-xl font-semibold text-sky-600 mb-3 text-center">å„åˆ†ç±»è¿›åº¦</h3>
                    <div id="category-progress-display" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    </div>
                </div>

                <div id="learning-goals-content" class="learning-hub-content hidden">
                    <h2 class="text-xl sm:text-2xl font-bold text-sky-600 mb-4 text-center">ğŸ¯ å­¦ä¹ ç›®æ ‡</h2>
                    <p class="text-center text-stone-600 mb-6 text-base">è®¾å®šå’Œè¿½è¸ªæ‚¨çš„å­¦ä¹ ç›®æ ‡ï¼Œä¿æŒå­¦ä¹ åŠ¨åŠ›ã€‚</p>
                    
                    <!-- å½“å‰ç›®æ ‡ -->
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-purple-700 mb-3">ğŸ¯ å½“å‰ç›®æ ‡</h3>
                        <div id="current-goals-display">
                            <!-- åŠ¨æ€ç”Ÿæˆç›®æ ‡å†…å®¹ -->
                        </div>
                    </div>
                    
                    <!-- è®¾å®šæ–°ç›®æ ‡ -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-blue-700 mb-3">â• è®¾å®šæ–°ç›®æ ‡</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-2">ç›®æ ‡ç±»å‹</label>
                                <select id="goal-type-select" class="w-full p-2 border border-stone-300 rounded-md">
                                    <option value="daily">æ¯æ—¥å­¦ä¹ </option>
                                    <option value="weekly">æ¯å‘¨å­¦ä¹ </option>
                                    <option value="total">æ€»å­¦ä¹ é‡</option>
                                    <option value="streak">è¿ç»­å­¦ä¹ </option>
                                    <option value="category">åˆ†ç±»å®Œæˆ</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-2">ç›®æ ‡æ•°å€¼</label>
                                <input type="number" id="goal-value-input" class="w-full p-2 border border-stone-300 rounded-md" min="1" value="10">
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-stone-700 mb-2">ç›®æ ‡æè¿°</label>
                            <input type="text" id="goal-description-input" class="w-full p-2 border border-stone-300 rounded-md" placeholder="ä¾‹å¦‚ï¼šæ¯å¤©å­¦ä¹ 5ä¸ªæ–°çŸ­è¯­">
                        </div>
                        <button id="add-goal-button" class="mt-4 action-button py-2 px-4 rounded-lg">ğŸ¯ æ·»åŠ ç›®æ ‡</button>
                    </div>
                    
                    <!-- ç›®æ ‡å†å² -->
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-700 mb-3">ğŸ† å·²å®Œæˆç›®æ ‡</h3>
                        <div id="completed-goals-display">
                            <!-- åŠ¨æ€ç”Ÿæˆå·²å®Œæˆç›®æ ‡ -->
                        </div>
                    </div>
                </div>

                <div id="learning-insights-content" class="learning-hub-content hidden">
                    <h2 class="text-xl sm:text-2xl font-bold text-sky-600 mb-4 text-center">ğŸ’¡ å­¦ä¹ æ´å¯Ÿ</h2>
                    <p class="text-center text-stone-600 mb-6 text-base">åŸºäºæ‚¨çš„å­¦ä¹ æ•°æ®ï¼Œä¸ºæ‚¨æä¾›ä¸ªæ€§åŒ–çš„å­¦ä¹ å»ºè®®ã€‚</p>
                    
                    <!-- å­¦ä¹ æ¨¡å¼åˆ†æ -->
                    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-indigo-700 mb-3">ğŸ“ˆ å­¦ä¹ æ¨¡å¼åˆ†æ</h3>
                        <div id="learning-patterns-display">
                            <!-- åŠ¨æ€ç”Ÿæˆå­¦ä¹ æ¨¡å¼åˆ†æ -->
                        </div>
                    </div>
                    
                    <!-- ä¸ªæ€§åŒ–å»ºè®® -->
                    <div class="bg-gradient-to-r from-orange-50 to-red-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-orange-700 mb-3">ğŸ’¡ ä¸ªæ€§åŒ–å»ºè®®</h3>
                        <div id="personalized-suggestions-display">
                            <!-- åŠ¨æ€ç”Ÿæˆä¸ªæ€§åŒ–å»ºè®® -->
                        </div>
                    </div>
                    
                    <!-- å­¦ä¹ æ•ˆç‡åˆ†æ -->
                    <div class="bg-gradient-to-r from-teal-50 to-green-50 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold text-teal-700 mb-3">âš¡ å­¦ä¹ æ•ˆç‡åˆ†æ</h3>
                        <div id="efficiency-analysis-display">
                            <!-- åŠ¨æ€ç”Ÿæˆæ•ˆç‡åˆ†æ -->
                        </div>
                    </div>
                    
                    <!-- é¢„æµ‹å’Œè§„åˆ’ -->
                    <div class="bg-gradient-to-r from-pink-50 to-rose-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-pink-700 mb-3">ğŸ”® å­¦ä¹ é¢„æµ‹</h3>
                        <div id="learning-predictions-display">
                            <!-- åŠ¨æ€ç”Ÿæˆå­¦ä¹ é¢„æµ‹ -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="text-center mt-12 py-8 border-t border-gradient-to-r from-sky-200 to-teal-200 bg-white/30 backdrop-blur-sm rounded-t-2xl">
            <div class="mb-4">
                <p class="text-stone-600 text-sm mb-2">ğŸ’¡ ä½¿ç”¨å°è´´å£«</p>
                <div class="flex flex-wrap justify-center gap-4 text-xs text-stone-500">
                    <span>ğŸ“± ç§»åŠ¨ç«¯ï¼šå·¦å³æ»‘åŠ¨åˆ‡æ¢å¡ç‰‡</span>
                    <span>âŒ¨ï¸ ç”µè„‘ç«¯ï¼šæ–¹å‘é”®å¯¼èˆªï¼Œç©ºæ ¼ç¿»è½¬</span>
                    <span>ğŸ”Š ç‚¹å‡»å–‡å­å›¾æ ‡å¬å‘éŸ³</span>
                </div>
            </div>
            <p class="text-stone-500 text-sm">&copy; 2024 æ¾æœå¹¼å„¿è‹±è¯­å­¦ä¹ åŠ©æ‰‹ âœ¨</p>
        </footer>
    </div>

    <script>
        const phrasesData = [
            {
                category: "é—®å€™åŠç¥ç¦",
                introduction: "å­¦ä¹ æ—¥å¸¸é—®å€™å’Œè¡¨è¾¾ç¥ç¦çš„åŸºæœ¬æ–¹å¼ï¼Œè®©å®è´ç¤¼è²Œå¾…äººã€‚",
                phrases: [
                    { en: "Hello!", zh: "ä½ å¥½!" }, { en: "Hi!", zh: "å—¨!" },
                    { en: "Good morning!", zh: "æ—©ä¸Šå¥½!" }, { en: "Good afternoon!", zh: "ä¸‹åˆå¥½!" },
                    { en: "Good evening!", zh: "æ™šä¸Šå¥½!" }, { en: "Good night!", zh: "æ™šå®‰!" },
                    { en: "Goodbye!", zh: "å†è§!" }, { en: "See you!", zh: "å†è§!" },
                    { en: "See you later!", zh: "å¾…ä¼šå„¿è§!" }, { en: "See you tomorrow!", zh: "æ˜å¤©è§!" },
                    { en: "See you next time.", zh: "ä¸‹æ¬¡è§ã€‚" }, { en: "Thank you.", zh: "è°¢è°¢ã€‚" },
                    { en: "You're welcome.", zh: "ä¸å®¢æ°”ã€‚" }, { en: "Please.", zh: "è¯·ã€‚" },
                    { en: "Excuse me.", zh: "æ‰“æ‰°ä¸€ä¸‹/è¯·åŸè°…ã€‚" }, { en: "I'm sorry.", zh: "å¯¹ä¸èµ·ã€‚" },
                    { en: "Never mind.", zh: "æ²¡å…³ç³»ã€‚" }, { en: "How are you?", zh: "ä½ å¥½å—?" },
                    { en: "I'm fine, thank you.", zh: "æˆ‘å¾ˆå¥½ï¼Œè°¢è°¢ä½ ã€‚" }, { en: "Are you OK?", zh: "ä½ è¿˜å¥½å—?" },
                    { en: "Yes, I am OK.", zh: "æˆ‘æŒºå¥½çš„ã€‚" }, { en: "Nice to meet you.", zh: "è§åˆ°ä½ å¾ˆé«˜å…´ã€‚" },
                    { en: "Nice to see you again.", zh: "å¾ˆé«˜å…´å†æ¬¡è§åˆ°ä½ ã€‚" }, { en: "Hello, everyone!", zh: "å¤§å®¶å¥½!" },
                    { en: "Hi, friend!", zh: "å—¨ï¼Œæœ‹å‹!" }, { en: "Have a good day!", zh: "ç¥ä½ ä»Šå¤©æ„‰å¿«!" },
                    { en: "Have fun!", zh: "ç©å¾—å¼€å¿ƒ!" }, { en: "Happy birthday!", zh: "ç”Ÿæ—¥å¿«ä¹!" },
                    { en: "Merry Christmas!", zh: "åœ£è¯å¿«ä¹!" }, { en: "Happy New Year!", zh: "æ–°å¹´å¿«ä¹!" }
                ]
            },
            {
                category: "æ—¥å¸¸ç”Ÿæ´»",
                introduction: "æŒæ¡ä¸æ—¥å¸¸ç”Ÿæ´»ç›¸å…³çš„å¸¸ç”¨è¡¨è¾¾ï¼Œä¾‹å¦‚æ´—æ¼±ã€ç©¿è¡£ã€å¦‚å•ç­‰ã€‚",
                phrases: [
                    { en: "Wake up!", zh: "èµ·åºŠäº†!" }, { en: "Get up!", zh: "èµ·æ¥!" },
                    { en: "Brush your teeth.", zh: "åˆ·ç‰™ã€‚" }, { en: "Wash your face.", zh: "æ´—è„¸ã€‚" },
                    { en: "Comb your hair.", zh: "æ¢³å¤´ã€‚" }, { en: "Put on your clothes!", zh: "ç©¿ä¸Šè¡£æœã€‚" },
                    { en: "Take off your shoes.", zh: "è„±é‹ã€‚" }, { en: "Put on your shoes.", zh: "ç©¿é‹ã€‚" },
                    { en: "Let's go!", zh: "æˆ‘ä»¬èµ°å§!" }, { en: "Come on!", zh: "å¿«ç‚¹!" },
                    { en: "I want to go to the toilet.", zh: "æˆ‘æƒ³ä¸Šå•æ‰€ã€‚" }, { en: "Are you ready?", zh: "ä½ å‡†å¤‡å¥½äº†å—?" },
                    { en: "I'm ready.", zh: "æˆ‘å‡†å¤‡å¥½äº†ã€‚" }, { en: "Where are you?", zh: "ä½ åœ¨å“ªå„¿?" },
                    { en: "There you are!", zh: "ä½ åœ¨è¿™å„¿ã€‚" }, { en: "Don't cry!", zh: "åˆ«å“­!" },
                    { en: "Be happy!", zh: "å¼€å¿ƒç‚¹!" }, { en: "Be quiet!", zh: "å®‰é™!" },
                    { en: "Listen carefully.", zh: "ä»”ç»†å¬ã€‚" }, { en: "Look at me.", zh: "çœ‹ç€æˆ‘ã€‚" },
                    { en: "Wait a minute.", zh: "ç­‰ä¸€ä¸‹ã€‚" }, { en: "Come here.", zh: "æ¥è¿™é‡Œã€‚" },
                    { en: "Go there.", zh: "å»é‚£å„¿ã€‚" }, { en: "Sit down, please.", zh: "è¯·åä¸‹ã€‚" },
                    { en: "Stand up, please.", zh: "è¯·ç«™èµ·æ¥ã€‚" }, { en: "Hands up.", zh: "ä¸¾èµ·æ‰‹æ¥ã€‚" },
                    { en: "Hands down.", zh: "æ”¾ä¸‹æ‰‹ã€‚" }, { en: "Close your eyes.", zh: "é—­ä¸Šçœ¼ç›ã€‚" },
                    { en: "Open your eyes.", zh: "çå¼€çœ¼ç›ã€‚" }, { en: "Show me your hands.", zh: "ç»™æˆ‘çœ‹çœ‹ä½ çš„æ‰‹ã€‚" },
                    { en: "Wash your hands.", zh: "æ´—æ‰‹ã€‚" }, { en: "Clean up!", zh: "æ”¶æ‹¾å¥½!" },
                    { en: "It's time to sleep.", zh: "è¯¥ç¡è§‰äº†ã€‚" }, { en: "Sweet dreams.", zh: "åšä¸ªå¥½æ¢¦ã€‚" },
                    { en: "Let's go home.", zh: "æˆ‘ä»¬å›å®¶å§ã€‚" }, { en: "What's wrong?", zh: "æ€ä¹ˆäº†?" },
                    { en: "I don't know.", zh: "æˆ‘ä¸çŸ¥é“ã€‚" }, { en: "I understand.", zh: "æˆ‘æ˜ç™½äº†ã€‚" }
                ]
            },
            {
                category: "è¿›é¤ç›¸å…³",
                introduction: "å­¦ä¹ åœ¨åƒé¥­æ—¶ä¼šç”¨åˆ°çš„è¡¨è¾¾ï¼Œå¦‚è¡¨è¾¾é¥¥é¥¿ã€ç‚¹é¤ã€è¡¨ç¤ºåƒé¥±ç­‰ã€‚",
                phrases: [
                    { en: "I am hungry.", zh: "æˆ‘é¥¿äº†ã€‚" }, { en: "I am thirsty.", zh: "æˆ‘æ¸´äº†ã€‚" },
                    { en: "Are you hungry?", zh: "ä½ é¥¿å—?" }, { en: "Are you thirsty?", zh: "ä½ æ¸´å—?" },
                    { en: "It's time for breakfast.", zh: "è¯¥åƒæ—©é¥­äº†ã€‚" }, { en: "It's time for lunch.", zh: "è¯¥åƒåˆé¥­äº†ã€‚" },
                    { en: "It's time for dinner.", zh: "è¯¥åƒæ™šé¥­äº†ã€‚" }, { en: "What's for breakfast/lunch/dinner?", zh: "æ—©é¥­/åˆé¥­/æ™šé¥­åƒä»€ä¹ˆ?" },
                    { en: "I want more rice/vegetable.", zh: "æˆ‘è¿˜æƒ³è¦ç±³é¥­/èœã€‚" }, { en: "I want some water/milk/juice.", zh: "æˆ‘æƒ³è¦äº›æ°´/ç‰›å¥¶/æœæ±ã€‚" },
                    { en: "I am full.", zh: "æˆ‘åƒé¥±äº†ã€‚" }, { en: "I don't like it.", zh: "æˆ‘ä¸å–œæ¬¢å®ƒã€‚" },
                    { en: "It's delicious!", zh: "çœŸå¥½åƒ!" }, { en: "Yummy!", zh: "å¥½åƒ!" },
                    { en: "Have some water/tea/milk.", zh: "å–ä¸€äº›æ°´/èŒ¶/ç‰›å¥¶ã€‚" }, { en: "Take a bite.", zh: "å’¬ä¸€å£ã€‚" },
                    { en: "Eat slowly.", zh: "æ…¢æ…¢åƒã€‚" }, { en: "Chew carefully.", zh: "å°å¿ƒå’€åš¼ã€‚" },
                    { en: "I have done my hands.", zh: "æˆ‘æ´—è¿‡æ‰‹äº†ã€‚" }, { en: "There is no tissue paper.", zh: "æ²¡æœ‰é¤å·¾çº¸äº†ã€‚" },
                    { en: "Can I have a napkin?", zh: "æˆ‘å¯ä»¥è¦ä¸€å¼ é¤å·¾çº¸å—?" }, { en: "I spilled my soup.", zh: "æˆ‘æŠŠæ±¤æ’’äº†ã€‚" },
                    { en: "Clean up the mess.", zh: "æŠŠè„ä¹±æ”¶æ‹¾å¹²å‡€ã€‚" }, { en: "Help yourself.", zh: "åˆ«å®¢æ°”ã€‚" },
                    { en: "Thank you for the food.", zh: "è°¢è°¢ä½ çš„é£Ÿç‰©ã€‚" }, { en: "Finish your food.", zh: "åƒå®Œä½ çš„é£Ÿç‰©ã€‚" }
                ]
            },
            {
                category: "èµç¾åŠé¼“åŠ±",
                introduction: "å­¦ä¼šç”¨ç§¯æçš„è¯­è¨€èµç¾å’Œé¼“åŠ±ä»–äººï¼ŒåŸ¹å…»å®è´çš„æ­£é¢æ²Ÿé€šèƒ½åŠ›ã€‚",
                phrases: [
                    { en: "Very good!", zh: "éå¸¸å¥½!" }, { en: "Good job!", zh: "å¹²å¾—ä¸é”™!" },
                    { en: "Well done!", zh: "å¹²å¾—å¥½!" }, { en: "Excellent!", zh: "å¤ªæ£’äº†!" },
                    { en: "Wonderful!", zh: "ç²¾å½©!" }, { en: "Amazing!", zh: "ä»¤äººæƒŠå¹!" },
                    { en: "You are smart!", zh: "ä½ çœŸèªæ˜!" }, { en: "You are clever!", zh: "ä½ çœŸæœºçµ!" },
                    { en: "You are so kind!", zh: "ä½ çœŸå–„è‰¯!" }, { en: "You are so helpful!", zh: "ä½ çœŸä¹äºåŠ©äºº!" },
                    { en: "Good idea.", zh: "å¥½ä¸»æ„ã€‚" }, { en: "That's right!", zh: "å¯¹äº†!" },
                    { en: "Yes, you are right.", zh: "æ˜¯çš„, ä½ è¯´å¾—å¯¹ã€‚" }, { en: "I agree with you.", zh: "æˆ‘åŒæ„ä½ è¯´çš„è¯ã€‚" },
                    { en: "How beautiful!", zh: "å¤šç¾å•Š!" }, { en: "How cute!", zh: "å¤šå¯çˆ±å‘€!" },
                    { en: "How funny!", zh: "å¤šæœ‰è¶£å‘€!" }, { en: "I am proud of you.", zh: "æˆ‘ä¸ºä½ éª„å‚²ã€‚" },
                    { en: "Keep trying!", zh: "ç»§ç»­åŠªåŠ›!" }, { en: "Don't give up!", zh: "ä¸è¦æ”¾å¼ƒ!" },
                    { en: "You can do it!", zh: "ä½ èƒ½åšåˆ°!" }, { en: "I believe in you.", zh: "æˆ‘ç›¸ä¿¡ä½ ã€‚" },
                    { en: "You are the best!", zh: "ä½ æ˜¯æœ€æ£’çš„!" }, { en: "I am the first!", zh: "æˆ‘æ˜¯ç¬¬ä¸€å!" },
                    { en: "You win!", zh: "ä½ èµ¢äº†!" }, { en: "You lose.", zh: "ä½ è¾“äº†ã€‚" }
                ]
            },
            {
                category: "æ¸¸æˆåŠæŒ‡ä»¤",
                introduction: "å­¦ä¹ åœ¨ç©æ¸¸æˆå’Œæ—¥å¸¸äº’åŠ¨ä¸­å¸¸ç”¨çš„æŒ‡ä»¤å’Œè¡¨è¾¾ã€‚",
                phrases: [
                    { en: "Let's begin/start.", zh: "æˆ‘ä»¬å¼€å§‹ã€‚" }, { en: "Are you ready?", zh: "å‡†å¤‡å¥½äº†å—?" },
                    { en: "One, two, three, go!", zh: "ä¸€ã€äºŒã€ä¸‰, å¼€å§‹!" }, { en: "Who is the winner?", zh: "è°èµ¢äº†?" },
                    { en: "Who wants to have a try?", zh: "è°æ„¿æ„æ¥è¯•ä¸€è¯•?" }, { en: "Look out!", zh: "å°å¿ƒ!" },
                    { en: "Be careful!", zh: "å°å¿ƒ!" }, { en: "It's your turn.", zh: "è½®åˆ°ä½ äº†ã€‚" },
                    { en: "My turn!", zh: "è½®åˆ°æˆ‘äº†!" }, { en: "Your turn!", zh: "è½®åˆ°ä½ äº†!" },
                    { en: "Please follow me.", zh: "è¯·è·Ÿæˆ‘å­¦ã€‚" }, { en: "Watch me!", zh: "çœ‹ç€æˆ‘!" },
                    { en: "Really?", zh: "çœŸçš„å—?" }, { en: "Are you sure?", zh: "ä½ è‚¯å®šå—?" },
                    { en: "Louder, please.", zh: "è¯·å¤§å£°ç‚¹ã€‚" }, { en: "Try again!", zh: "å†è¯•ä¸€æ¬¡!" },
                    { en: "Hurry up!", zh: "èµ¶å¿«!" }, { en: "Take it easy!", zh: "æ…¢æ…¢æ¥!" },
                    { en: "Let's jump.", zh: "æˆ‘ä»¬ä¸€èµ·è·³ã€‚" }, { en: "Clap your hands.", zh: "æ‹æ‰‹ã€‚" },
                    { en: "Stamp your feet.", zh: "è·ºè„šã€‚" }, { en: "Shake your body.", zh: "æ‘‡æ‘‡èº«ä½“ã€‚" },
                    { en: "Stretch your arms.", zh: "ä¼¸ä¼¸èƒ³è†Šã€‚" }, { en: "Shake your head.", zh: "æ‘‡æ‘‡å¤´ã€‚" },
                    { en: "Nod your head.", zh: "ç‚¹ç‚¹å¤´ã€‚" }, { en: "Wiggle your fingers.", zh: "åŠ¨åŠ¨æ‰‹æŒ‡ã€‚" },
                    { en: "Let's sing a song.", zh: "æˆ‘ä»¬æ¥å”±é¦–æ­Œã€‚" }, { en: "Let's dance.", zh: "æˆ‘ä»¬æ¥è·³èˆã€‚" },
                    { en: "Let's play a game.", zh: "æˆ‘ä»¬ç©æ¸¸æˆå§ã€‚" }, { en: "Can you sing/dance/jump?", zh: "ä½ å¯ä»¥å”±æ­Œ/è·³èˆ/è¹¦å—?" },
                    { en: "Show me your nose/hands/feet.", zh: "ç»™æˆ‘çœ‹çœ‹ä½ çš„é¼»å­/æ‰‹/è„šã€‚" }, { en: "Point to the door.", zh: "æŒ‡å‘é—¨ã€‚" },
                    { en: "Touch your stomach.", zh: "æ‘¸æ‘¸ä½ çš„è‚šå­ã€‚" }, { en: "Turn around.", zh: "è½¬ä¸ªåœˆã€‚" },
                    { en: "Run fast!", zh: "å¿«è·‘!" }, { en: "Walk slowly.", zh: "æ…¢æ…¢èµ°ã€‚" },
                    { en: "Stop!", zh: "åœ!" }, { en: "Go!", zh: "èµ°!" },
                    { en: "Line up, please.", zh: "è¯·æ’é˜Ÿã€‚" }, { en: "Make a circle.", zh: "å›´æˆä¸€ä¸ªåœˆã€‚" },
                    { en: "Stand in a row.", zh: "ç«™æˆä¸€æ’ã€‚" }, { en: "Stand in a circle, hand in hand.", zh: "ç«™æˆåœˆ, æ‰‹æ‹‰æ‰‹ã€‚" },
                    { en: "Make a big circle.", zh: "ç«™æˆä¸€ä¸ªå¤§åœˆã€‚" }, { en: "Make a small circle.", zh: "ç«™æˆä¸€ä¸ªå°åœˆã€‚" }
                ]
            },
            {
                category: "æ„Ÿå†’ç”Ÿç—…",
                introduction: "å­¦ä¹ æè¿°èº«ä½“ä¸é€‚å’Œç”Ÿç—…æ—¶çš„å¸¸ç”¨è¯­ï¼Œä»¥åŠè¡¨è¾¾å…³å¿ƒã€‚",
                phrases: [
                    { en: "I feel sick.", zh: "æˆ‘æ„Ÿè§‰ä¸èˆ’æœã€‚" }, { en: "I was sick yesterday.", zh: "æˆ‘æ˜¨å¤©ç—…äº†ã€‚" },
                    { en: "I'm better today.", zh: "æˆ‘ä»Šå¤©å¥½äº†ã€‚" }, { en: "I have a cough.", zh: "æˆ‘å’³å—½ã€‚" },
                    { en: "I have a runny nose.", zh: "æˆ‘æµé¼»æ¶•ã€‚" }, { en: "I have a sore throat.", zh: "æˆ‘å–‰å’™ç—›ã€‚" },
                    { en: "I got a headache.", zh: "æˆ‘å¤´ç–¼ã€‚" }, { en: "I got a cold.", zh: "æˆ‘æ„Ÿå†’äº†ã€‚" },
                    { en: "I have a fever.", zh: "æˆ‘å‘çƒ§äº†ã€‚" }, { en: "You are very very hot.", zh: "ä½ å‘é«˜çƒ§äº†ã€‚" },
                    { en: "My teeth got a pain.", zh: "æˆ‘ç‰™ç–¼ã€‚" }, { en: "My stomach hurts.", zh: "æˆ‘è‚šå­ç–¼ã€‚" },
                    { en: "I feel dizzy.", zh: "æˆ‘å¤´æ™•ã€‚" }, { en: "I want to throw up.", zh: "æˆ‘æƒ³åã€‚" },
                    { en: "Take your medicine.", zh: "åƒè¯ã€‚" }, { en: "Drink more water.", zh: "å¤šå–æ°´ã€‚" },
                    { en: "Get some rest.", zh: "å¤šä¼‘æ¯ã€‚" }, { en: "Are you feeling better?", zh: "ä½ æ„Ÿè§‰å¥½äº›äº†å—?" },
                    { en: "I miss my Mummy.", zh: "æˆ‘æƒ³æˆ‘å¦ˆå¦ˆã€‚" }, { en: "I miss my Daddy.", zh: "æˆ‘æƒ³æˆ‘çˆ¸çˆ¸ã€‚" },
                    { en: "Check it out.", zh: "æ£€æŸ¥ä¸€ä¸‹ã€‚" }, { en: "Let's go to the doctor.", zh: "æˆ‘ä»¬å»çœ‹åŒ»ç”Ÿå§ã€‚" }
                ]
            },
            {
                category: "æˆ·å¤–æ´»åŠ¨",
                introduction: "æŒæ¡åœ¨æˆ·å¤–æ´»åŠ¨å’Œé›†ä½“æ¸¸æˆæ—¶ä¼šç”¨åˆ°çš„æŒ‡ä»¤å’Œäº¤æµã€‚",
                phrases: [
                    { en: "Let's go out to play.", zh: "æˆ‘ä»¬å‡ºå»ç©å§ã€‚" }, { en: "Ready? One, two, go!", zh: "å‡†å¤‡å¥½äº†å—? å‡ºå‘!" },
                    { en: "One step forward.", zh: "å‰è¿›ä¸€æ­¥ã€‚" }, { en: "One step back.", zh: "åé€€ä¸€æ­¥ã€‚" },
                    { en: "Turn around and face me, please.", zh: "è¯·è½¬èº«é¢å‘æˆ‘ã€‚" }, { en: "Let's go back to the classroom.", zh: "æˆ‘ä»¬å›æ•™å®¤å§ã€‚" },
                    { en: "Let's have a rest.", zh: "æˆ‘ä»¬ä¼‘æ¯ä¸€ä¸‹ã€‚" }, { en: "We want to play hide and seek.", zh: "æˆ‘ä»¬æƒ³ç©æ‰è¿·è—ã€‚" },
                    { en: "Let's play tag.", zh: "æˆ‘ä»¬ç©æ‰äººæ¸¸æˆå§ã€‚" }, { en: "Let's play on the slide.", zh: "æˆ‘ä»¬å»ç©æ»‘æ¢¯å§ã€‚" },
                    { en: "Let's play on the swing.", zh: "æˆ‘ä»¬å»ç©ç§‹åƒå§ã€‚" }, { en: "Let's kick the ball.", zh: "æˆ‘ä»¬è¸¢çƒå§ã€‚" },
                    { en: "Let's throw the ball.", zh: "æˆ‘ä»¬æ‰”çƒå§ã€‚" }, { en: "Let's catch the ball.", zh: "æˆ‘ä»¬æ¥çƒå§ã€‚" },
                    { en: "Look, a bird!", zh: "çœ‹ï¼Œä¸€åªé¸Ÿ!" }, { en: "Look, a flower!", zh: "çœ‹ï¼Œä¸€æœµèŠ±!" },
                    { en: "It's sunny today.", zh: "ä»Šå¤©å¤©æ°”æ™´æœ—ã€‚" }, { en: "It's raining.", zh: "ä¸‹é›¨äº†ã€‚" },
                    { en: "It's windy.", zh: "åˆ®é£äº†ã€‚" }, { en: "It's cold.", zh: "å¾ˆå†·ã€‚" },
                    { en: "It's hot.", zh: "å¾ˆçƒ­ã€‚" }, { en: "Put on your coat.", zh: "ç©¿ä¸Šä½ çš„å¤–å¥—ã€‚" },
                    { en: "Take off your hat.", zh: "è„±æ‰ä½ çš„å¸½å­ã€‚" }, { en: "Who is not here?", zh: "è°æ²¡æœ‰åˆ°å‘¢?" }
                ]
            },
            {
                category: "å­¦ä¹ ä¸è¯¾å ‚",
                introduction: "å­¦ä¹ åœ¨è¯¾å ‚å’Œå­¦ä¹ æ´»åŠ¨ä¸­å¸¸ç”¨çš„è¡¨è¾¾ï¼Œå¸®åŠ©å®è´èå…¥å­¦ä¹ ç¯å¢ƒã€‚",
                phrases: [
                    { en: "Open your book.", zh: "æ‰“å¼€ä½ çš„ä¹¦ã€‚" }, { en: "Close your book.", zh: "åˆä¸Šä½ çš„ä¹¦ã€‚" },
                    { en: "Take out your pencil.", zh: "æ‹¿å‡ºä½ çš„é“…ç¬”ã€‚" }, { en: "Put away your toys.", zh: "æ”¶å¥½ä½ çš„ç©å…·ã€‚" },
                    { en: "Draw a picture.", zh: "ç”»ä¸€å¹…ç”»ã€‚" }, { en: "Color it red.", zh: "æŠŠå®ƒæ¶‚æˆçº¢è‰²ã€‚" },
                    { en: "Write your name.", zh: "å†™ä½ çš„åå­—ã€‚" }, { en: "Read after me.", zh: "è·Ÿæˆ‘è¯»ã€‚" },
                    { en: "Repeat after me.", zh: "è·Ÿæˆ‘é‡å¤ã€‚" }, { en: "Say it again.", zh: "å†è¯´ä¸€éã€‚" },
                    { en: "What's this?", zh: "è¿™æ˜¯ä»€ä¹ˆ?" }, { en: "It's a book.", zh: "è¿™æ˜¯ä¸€æœ¬ä¹¦ã€‚" },
                    { en: "What color is it?", zh: "å®ƒæ˜¯ä»€ä¹ˆé¢œè‰²?" }, { en: "It's blue.", zh: "å®ƒæ˜¯è“è‰²çš„ã€‚" },
                    { en: "How many?", zh: "æœ‰å¤šå°‘ä¸ª?" }, { en: "Count with me.", zh: "å’Œæˆ‘ä¸€èµ·æ•°ã€‚" },
                    { en: "Let's learn.", zh: "æˆ‘ä»¬æ¥å­¦ä¹ ã€‚" }, { en: "It's learning time.", zh: "åˆ°å­¦ä¹ æ—¶é—´äº†ã€‚" },
                    { en: "Do you understand?", zh: "ä½ æ˜ç™½å—?" }, { en: "Yes, I understand.", zh: "æ˜¯çš„ï¼Œæˆ‘æ˜ç™½äº†ã€‚" },
                    { en: "No, I don't understand.", zh: "ä¸ï¼Œæˆ‘ä¸æ˜ç™½ã€‚" }, { en: "Raise your hand.", zh: "ä¸¾æ‰‹ã€‚" },
                    { en: "Answer the question.", zh: "å›ç­”é—®é¢˜ã€‚" }, { en: "Good listening!", zh: "å¬å¾—çœŸå¥½!" },
                    { en: "Pay attention.", zh: "è¯·æ³¨æ„ã€‚" }, { en: "Share your toys.", zh: "åˆ†äº«ä½ çš„ç©å…·ã€‚" },
                    { en: "Help your friends.", zh: "å¸®åŠ©ä½ çš„æœ‹å‹ã€‚" }, { en: "Be polite.", zh: "æœ‰ç¤¼è²Œã€‚" }
                ]
            },
            {
                category: "æƒ…ç»ªä¸æ„Ÿå—",
                introduction: "å¸®åŠ©å®è´è¡¨è¾¾è‡ªå·±çš„æƒ…ç»ªï¼Œå¹¶ç†è§£ä»–äººçš„æ„Ÿå—ã€‚",
                phrases: [
                    { en: "I am happy.", zh: "æˆ‘å¾ˆå¼€å¿ƒã€‚" }, { en: "I am sad.", zh: "æˆ‘å¾ˆä¼¤å¿ƒã€‚" },
                    { en: "I am angry.", zh: "æˆ‘å¾ˆç”Ÿæ°”ã€‚" }, { en: "I am scared.", zh: "æˆ‘å¾ˆå®³æ€•ã€‚" },
                    { en: "I am tired.", zh: "æˆ‘å¾ˆç´¯ã€‚" }, { en: "I am excited!", zh: "æˆ‘å¾ˆå…´å¥‹!" },
                    { en: "I am sleepy.", zh: "æˆ‘å¾ˆå›°ã€‚" }, { en: "I am bored.", zh: "æˆ‘å¾ˆæ— èŠã€‚" },
                    { en: "Are you happy?", zh: "ä½ å¼€å¿ƒå—?" }, { en: "Don't be sad.", zh: "åˆ«ä¼¤å¿ƒã€‚" },
                    { en: "Cheer up!", zh: "æŒ¯ä½œèµ·æ¥!" }, { en: "It's okay.", zh: "æ²¡å…³ç³»ã€‚" },
                    { en: "Give me a hug.", zh: "ç»™æˆ‘ä¸€ä¸ªæ‹¥æŠ±ã€‚" }, { en: "Are you okay?", zh: "ä½ è¿˜å¥½å—?" },
                    { en: "I feel good.", zh: "æˆ‘æ„Ÿè§‰å¾ˆå¥½ã€‚" }, { en: "I feel bad.", zh: "æˆ‘æ„Ÿè§‰ä¸å¥½ã€‚" },
                    { en: "What makes you happy?", zh: "ä»€ä¹ˆè®©ä½ å¼€å¿ƒ?" }, { en: "What makes you sad?", zh: "ä»€ä¹ˆè®©ä½ ä¼¤å¿ƒ?" }
                ]
            },
            {
                category: "é¢œè‰²ã€æ•°å­—ã€å½¢çŠ¶",
                introduction: "å­¦ä¹ åŸºç¡€çš„é¢œè‰²ã€æ•°å­—å’Œå½¢çŠ¶è¯æ±‡ï¼Œæ‹“å±•è®¤çŸ¥èƒ½åŠ›ã€‚",
                phrases: [
                    { en: "What color is this?", zh: "è¿™æ˜¯ä»€ä¹ˆé¢œè‰²?" }, { en: "It's red.", zh: "å®ƒæ˜¯çº¢è‰²çš„ã€‚" },
                    { en: "It's yellow.", zh: "å®ƒæ˜¯é»„è‰²çš„ã€‚" }, { en: "It's blue.", zh: "å®ƒæ˜¯è“è‰²çš„ã€‚" },
                    { en: "It's green.", zh: "å®ƒæ˜¯ç»¿è‰²çš„ã€‚" }, { en: "It's black.", zh: "å®ƒæ˜¯é»‘è‰²çš„ã€‚" },
                    { en: "It's white.", zh: "å®ƒæ˜¯ç™½è‰²çš„ã€‚" }, { en: "It's orange.", zh: "å®ƒæ˜¯æ©™è‰²çš„ã€‚" },
                    { en: "It's purple.", zh: "å®ƒæ˜¯ç´«è‰²çš„ã€‚" }, { en: "It's pink.", zh: "å®ƒæ˜¯ç²‰è‰²çš„ã€‚" },
                    { en: "How many apples?", zh: "æœ‰å¤šå°‘ä¸ªè‹¹æœ?" }, { en: "One, two, three.", zh: "ä¸€ï¼ŒäºŒï¼Œä¸‰ã€‚" },
                    { en: "Let's count.", zh: "æˆ‘ä»¬æ¥æ•°æ•°ã€‚" }, { en: "What shape is this?", zh: "è¿™æ˜¯ä»€ä¹ˆå½¢çŠ¶?" },
                    { en: "It's a circle.", zh: "å®ƒæ˜¯ä¸€ä¸ªåœ†å½¢ã€‚" }, { en: "It's a square.", zh: "å®ƒæ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ã€‚" },
                    { en: "It's a triangle.", zh: "å®ƒæ˜¯ä¸€ä¸ªä¸‰è§’å½¢ã€‚" }, { en: "It's a star.", zh: "å®ƒæ˜¯ä¸€ä¸ªæ˜Ÿæ˜Ÿã€‚" }
                ]
            },
            {
                category: "åŠ¨ç‰©ä¸å¤§è‡ªç„¶",
                introduction: "è®¤è¯†å¸¸è§çš„åŠ¨ç‰©å’Œè‡ªç„¶ç°è±¡ï¼ŒåŸ¹å…»å¯¹å‘¨å›´ä¸–ç•Œçš„å¥½å¥‡å¿ƒã€‚",
                phrases: [
                    { en: "What's that animal?", zh: "é‚£æ˜¯ä»€ä¹ˆåŠ¨ç‰©?" }, { en: "It's a dog.", zh: "å®ƒæ˜¯ä¸€åªç‹—ã€‚" },
                    { en: "It's a cat.", zh: "å®ƒæ˜¯ä¸€åªçŒ«ã€‚" }, { en: "It's a bird.", zh: "å®ƒæ˜¯ä¸€åªé¸Ÿã€‚" },
                    { en: "It's a fish.", zh: "å®ƒæ˜¯ä¸€æ¡é±¼ã€‚" }, { en: "It's a monkey.", zh: "å®ƒæ˜¯ä¸€åªçŒ´å­ã€‚" },
                    { en: "It's a lion.", zh: "å®ƒæ˜¯ä¸€åªç‹®å­ã€‚" }, { en: "It's an elephant.", zh: "å®ƒæ˜¯ä¸€å¤´å¤§è±¡ã€‚" },
                    { en: "What does the dog say?", zh: "ç‹—æ€ä¹ˆå«?" }, { en: "Woof, woof!", zh: "æ±ªï¼Œæ±ª!" },
                    { en: "The sun is shining.", zh: "å¤ªé˜³åœ¨ç…§è€€ã€‚" }, { en: "The moon is bright.", zh: "æœˆäº®å¾ˆäº®ã€‚" },
                    { en: "Look at the stars.", zh: "çœ‹æ˜Ÿæ˜Ÿã€‚" }, { en: "The sky is blue.", zh: "å¤©ç©ºæ˜¯è“è‰²çš„ã€‚" },
                    { en: "The grass is green.", zh: "è‰æ˜¯ç»¿è‰²çš„ã€‚" }, { en: "What a beautiful flower!", zh: "å¤šä¹ˆç¾ä¸½çš„èŠ±å•Š!" },
                    { en: "Don't touch it.", zh: "ä¸è¦ç¢°å®ƒã€‚" }, { en: "Be gentle.", zh: "è¦æ¸©æŸ”ã€‚" }
                ]
            },
            {
                category: "å®¶åº­ä¸æœ‹å‹",
                introduction: "å­¦ä¹ å¦‚ä½•ç§°å‘¼å®¶åº­æˆå‘˜å’Œæœ‹å‹ï¼Œè¡¨è¾¾å¯¹ä»–ä»¬çš„çˆ±å’Œå…³å¿ƒã€‚",
                phrases: [
                    { en: "This is my mom.", zh: "è¿™æ˜¯æˆ‘å¦ˆå¦ˆã€‚" }, { en: "This is my dad.", zh: "è¿™æ˜¯æˆ‘çˆ¸çˆ¸ã€‚" },
                    { en: "This is my brother.", zh: "è¿™æ˜¯æˆ‘å“¥å“¥/å¼Ÿå¼Ÿã€‚" }, { en: "This is my sister.", zh: "è¿™æ˜¯æˆ‘å§å§/å¦¹å¦¹ã€‚" },
                    { en: "I love my family.", zh: "æˆ‘çˆ±æˆ‘çš„å®¶äººã€‚" }, { en: "Who is your best friend?", zh: "è°æ˜¯ä½ æœ€å¥½çš„æœ‹å‹?" },
                    { en: "He is my friend.", zh: "ä»–æ˜¯æˆ‘çš„æœ‹å‹ã€‚" }, { en: "She is my friend.", zh: "å¥¹æ˜¯æˆ‘çš„æœ‹å‹ã€‚" },
                    { en: "Let's play together.", zh: "æˆ‘ä»¬ä¸€èµ·ç©å§ã€‚" }, { en: "Share with your friends.", zh: "å’Œä½ çš„æœ‹å‹åˆ†äº«ã€‚" },
                    { en: "Be nice to your friends.", zh: "å¯¹ä½ çš„æœ‹å‹å‹å¥½ã€‚" }, { en: "Give me a high five!", zh: "å’Œæˆ‘å‡»æŒ!" },
                    { en: "I miss you.", zh: "æˆ‘æƒ³ä½ ã€‚" }, { en: "I love you.", zh: "æˆ‘çˆ±ä½ ã€‚" }
                ]
            },
            {
                category: "æé—®ä¸å›ç­”",
                introduction: "å­¦ä¹ ç®€å•çš„æé—®å’Œå›ç­”æ¨¡å¼ï¼Œå¸®åŠ©å®è´è¿›è¡ŒåŸºç¡€å¯¹è¯ã€‚",
                phrases: [
                    { en: "What's your name?", zh: "ä½ å«ä»€ä¹ˆåå­—?" }, { en: "My name is...", zh: "æˆ‘çš„åå­—æ˜¯..." },
                    { en: "How old are you?", zh: "ä½ å‡ å²äº†?" }, { en: "I am ... years old.", zh: "æˆ‘...å²äº†ã€‚" },
                    { en: "Where are you from?", zh: "ä½ æ¥è‡ªå“ªé‡Œ?" }, { en: "I'm from China.", zh: "æˆ‘æ¥è‡ªä¸­å›½ã€‚" },
                    { en: "What are you doing?", zh: "ä½ åœ¨åšä»€ä¹ˆ?" }, { en: "I'm playing.", zh: "æˆ‘åœ¨ç©ã€‚" },
                    { en: "Can I help you?", zh: "æˆ‘èƒ½å¸®ä½ å—?" }, { en: "Yes, please.", zh: "æ˜¯çš„ï¼Œè¯·ã€‚" },
                    { en: "No, thank you.", zh: "ä¸ï¼Œè°¢è°¢ã€‚" }, { en: "What do you want?", zh: "ä½ æƒ³è¦ä»€ä¹ˆ?" },
                    { en: "I want a toy.", zh: "æˆ‘æƒ³è¦ä¸€ä¸ªç©å…·ã€‚" }, { en: "Do you like it?", zh: "ä½ å–œæ¬¢å®ƒå—?" },
                    { en: "Yes, I like it.", zh: "æ˜¯çš„ï¼Œæˆ‘å–œæ¬¢å®ƒã€‚" }, { en: "No, I don't like it.", zh: "ä¸ï¼Œæˆ‘ä¸å–œæ¬¢å®ƒã€‚" },
                    { en: "Is it fun?", zh: "å¥½ç©å—?" }, { en: "Yes, it's fun!", zh: "æ˜¯çš„ï¼Œå¾ˆå¥½ç©!" },
                    { en: "No, it's not fun.", zh: "ä¸ï¼Œä¸å¥½ç©ã€‚" }, { en: "What's the weather like?", zh: "å¤©æ°”æ€ä¹ˆæ ·?" },
                    { en: "It's sunny.", zh: "æ˜¯æ™´å¤©ã€‚" }, { en: "It's cloudy.", zh: "æ˜¯é˜´å¤©ã€‚" }
                ]
            }
        ];

        const categoryButtonsContainer = document.getElementById('category-buttons');
        const phrasesContainer = document.getElementById('phrases-container');
        const categoryIntro = document.getElementById('category-intro');
        const flashcardModeButton = document.getElementById('flashcard-mode-button');
        const flashcardContainer = document.getElementById('flashcard-container');
        const flashcardDisplayArea = document.getElementById('flashcard-display-area');
        // Removed flashcardAssessmentButtons, rememberedButton, forgotButton as per simplified design
        const shuffleFlashcardsButton = document.getElementById('shuffle-flashcards-button');
        const flashcardSourceRadios = document.querySelectorAll('input[name="flashcard-source"]');
        const flashcardNavButtons = document.getElementById('flashcard-nav-buttons');
        const prevFlashcardButton = document.getElementById('prev-flashcard');
        const nextFlashcardButton = document.getElementById('next-flashcard');
        const markLearnedFlashcardButton = document.getElementById('mark-learned-flashcard-button'); // Get the new mark learned button
        const flashcardCounter = document.getElementById('flashcard-counter');

        const categoryBrowseButton = document.getElementById('category-browse-button');
        const learningHubButton = document.getElementById('learning-hub-button');
        const learningHubContainer = document.getElementById('learning-hub-container');

        const learningPlanTabButton = document.getElementById('learning-plan-tab-button');
        const reviewPlanTabButton = document.getElementById('review-plan-tab-button');
        const myProgressTabButton = document.getElementById('my-progress-tab-button');
        const learningGoalsTabButton = document.getElementById('learning-goals-tab-button');
        const learningInsightsTabButton = document.getElementById('learning-insights-tab-button');

        const learningPlanContent = document.getElementById('learning-plan-content');
        const reviewPlanContent = document.getElementById('review-plan-content');
        const myProgressContent = document.getElementById('my-progress-content');
        const learningGoalsContent = document.getElementById('learning-goals-content');
        const learningInsightsContent = document.getElementById('learning-insights-content');

        const phrasesPerDayInput = document.getElementById('phrases-per-day-input');
        const prevDayButton = document.getElementById('prev-day-button');
        const nextDayButton = document.getElementById('next-day-button');
        const currentDayDisplay = document.getElementById('current-day-display');
        const dailyPhrasesDisplay = document.getElementById('daily-phrases-display');

        const reviewPhrasesDisplay = document.getElementById('review-phrases-display');
        const refreshReviewButton = document.getElementById('refresh-review-button');

        const totalPhrasesCount = document.getElementById('total-phrases-count');
        const learnedPhrasesCount = document.getElementById('learned-phrases-count');
        const progressPercentage = document.getElementById('progress-percentage');
        const progressBarFill = document.getElementById('progress-bar-fill');
        const categoryProgressDisplay = document.getElementById('category-progress-display');


        let currentCategoryIndex = 0;
        let learnedPhrases = {}; // ä¿æŒå‘åå…¼å®¹
        let enhancedLearningData = {}; // æ–°çš„å¢å¼ºæ•°æ®ç»“æ„
        let currentFlashcardCategoryIndex = 0; // This is only used for category-based flashcard source, not for general flashcard navigation index
        let currentFlashcardIndex = 0;
        let currentMode = 'category-browse';
        let currentLearningHubTab = 'learning-plan';
        let phrasesPerDay = parseInt(phrasesPerDayInput.value);
        let currentLearningDay = 0;
        let currentReviewSetIndex = 0;
        let unlearnedPhrasesForReview = [];
        let userStats = {
            totalLearned: 0,
            consecutiveDays: 0,
            lastStudyDate: null,
            totalStudyTime: 0,
            averageAccuracy: 0,
            unlockedAchievements: [],
            learningMode: 'normal',
            dailyTarget: 5,
            todayCompleted: 0,
            goals: [],
            learningHistory: []
        };

        let allFlattenedPhrases = [];
        let flashcardSet = [];

        // Function Definitions
        function loadLearnedPhrases() {
            // åŠ è½½æ—§æ ¼å¼æ•°æ®ï¼ˆå‘åå…¼å®¹ï¼‰
            const stored = localStorage.getItem('learnedPhrases');
            if (stored) {
                learnedPhrases = JSON.parse(stored);
            }
            
            // åŠ è½½å¢å¼ºå­¦ä¹ æ•°æ®
            const enhancedStored = localStorage.getItem('enhancedLearningData');
            if (enhancedStored) {
                enhancedLearningData = JSON.parse(enhancedStored);
            }
            
            // åŠ è½½ç”¨æˆ·ç»Ÿè®¡æ•°æ®
            const statsStored = localStorage.getItem('userStats');
            if (statsStored) {
                userStats = { ...userStats, ...JSON.parse(statsStored) };
            }
            
            // è¿ç§»æ—§æ•°æ®åˆ°æ–°æ ¼å¼
            migrateOldData();
        }

        function saveLearnedPhrases() {
            localStorage.setItem('learnedPhrases', JSON.stringify(learnedPhrases));
            localStorage.setItem('enhancedLearningData', JSON.stringify(enhancedLearningData));
            localStorage.setItem('userStats', JSON.stringify(userStats));
            
            if (currentMode === 'learning-hub' && currentLearningHubTab === 'my-progress') {
                updateMyProgress();
            }
        }
        
        function migrateOldData() {
            // å°†æ—§çš„ç®€å•æ•°æ®è¿ç§»åˆ°æ–°çš„å¢å¼ºæ ¼å¼
            Object.keys(learnedPhrases).forEach(key => {
                if (learnedPhrases[key] && !enhancedLearningData[key]) {
                    enhancedLearningData[key] = {
                        learned: true,
                        firstLearnedAt: new Date().toISOString(),
                        lastReviewedAt: new Date().toISOString(),
                        reviewCount: 1,
                        masteryLevel: 0.6, // é»˜è®¤ç†Ÿç»ƒåº¦
                        difficulty: calculatePhraseDifficulty(key),
                        nextReviewAt: calculateNextReviewDate(1).toISOString(),
                        reviewHistory: [{
                            date: new Date().toISOString(),
                            result: 'correct',
                            responseTime: 3.0
                        }]
                    };
                }
            });
        }

        function initLearningPlan() {
            allFlattenedPhrases = [];
            phrasesData.forEach(category => {
                category.phrases.forEach(phrase => {
                    allFlattenedPhrases.push(phrase);
                });
            });
            
            // ä½¿ç”¨æ™ºèƒ½æ’åºç®—æ³•
            allFlattenedPhrases = optimizeLearningSequence(allFlattenedPhrases);
        }
        
        // æ™ºèƒ½å­¦ä¹ ç®—æ³•
        function calculatePhraseDifficulty(phraseKey) {
            // ä»keyä¸­æå–çŸ­è¯­æ–‡æœ¬
            const phrase = phraseKey.replace(/^.*_/, '');
            
            const factors = {
                length: phrase.length / 20, // æ ‡å‡†åŒ–é•¿åº¦
                wordCount: phrase.split(' ').length / 5, // æ ‡å‡†åŒ–å•è¯æ•°
                complexity: getGrammarComplexity(phrase),
                frequency: 1 - getPhraseFrequency(phrase), // é¢‘ç‡è¶Šä½éš¾åº¦è¶Šé«˜
                pronunciation: getPronunciationDifficulty(phrase)
            };
            
            // åŠ æƒè®¡ç®—æ€»éš¾åº¦ (0-1)
            return Math.min(1, Math.max(0,
                factors.length * 0.2 +
                factors.wordCount * 0.3 +
                factors.complexity * 0.3 +
                factors.frequency * 0.1 +
                factors.pronunciation * 0.1
            ));
        }
        
        function getGrammarComplexity(phrase) {
            // ç®€å•çš„è¯­æ³•å¤æ‚åº¦è¯„ä¼°
            const complexPatterns = [
                /\b(what|how|when|where|why)\b/i, // ç–‘é—®è¯
                /\b(can|could|would|should|might)\b/i, // æƒ…æ€åŠ¨è¯
                /\b(because|although|however|therefore)\b/i, // è¿æ¥è¯
                /'(s|re|ve|ll|t)\b/g // ç¼©å†™
            ];
            
            let complexity = 0;
            complexPatterns.forEach(pattern => {
                if (pattern.test(phrase)) complexity += 0.2;
            });
            
            return Math.min(1, complexity);
        }
        
        function getPhraseFrequency(phrase) {
            // åŸºäºå¸¸ç”¨è¯æ±‡çš„é¢‘ç‡è¯„ä¼°
            const commonWords = ['hello', 'hi', 'good', 'thank', 'please', 'yes', 'no', 'i', 'you', 'the', 'a', 'an'];
            const words = phrase.toLowerCase().split(' ');
            const commonWordCount = words.filter(word => commonWords.includes(word)).length;
            
            return Math.min(1, commonWordCount / words.length);
        }
        
        function getPronunciationDifficulty(phrase) {
            // ç®€å•çš„å‘éŸ³éš¾åº¦è¯„ä¼°
            const difficultSounds = ['th', 'r', 'l', 'v', 'w', 'ch', 'sh'];
            let difficulty = 0;
            
            difficultSounds.forEach(sound => {
                if (phrase.toLowerCase().includes(sound)) {
                    difficulty += 0.1;
                }
            });
            
            return Math.min(1, difficulty);
        }
        
        function optimizeLearningSequence(phrases) {
            return phrases.sort((a, b) => {
                const diffA = calculatePhraseDifficulty(`GLOBAL_${a.en}`);
                const diffB = calculatePhraseDifficulty(`GLOBAL_${b.en}`);
                
                // è€ƒè™‘è®¤çŸ¥è´Ÿè·é€’å¢
                if (Math.abs(diffA - diffB) < 0.1) {
                    // éš¾åº¦ç›¸è¿‘æ—¶ï¼ŒæŒ‰ä½¿ç”¨é¢‘ç‡æ’åº
                    return getPhraseFrequency(b.en) - getPhraseFrequency(a.en);
                }
                return diffA - diffB;
            });
        }
        
        // é—´éš”é‡å¤ç®—æ³•
        function calculateNextReviewDate(reviewCount, masteryLevel = 0.5, lastPerformance = 0.8) {
            let interval;
            
            if (lastPerformance >= 0.8) { // è¡¨ç°è‰¯å¥½
                if (reviewCount === 1) {
                    interval = 1; // 1å¤©å
                } else if (reviewCount === 2) {
                    interval = 3; // 3å¤©å
                } else if (reviewCount === 3) {
                    interval = 7; // 1å‘¨å
                } else {
                    interval = Math.round(Math.pow(2, reviewCount - 3) * 7); // æŒ‡æ•°å¢é•¿
                }
            } else { // è¡¨ç°ä¸ä½³
                interval = 1; // é‡æ–°å¼€å§‹
            }
            
            // æ ¹æ®ç†Ÿç»ƒåº¦è°ƒæ•´
            interval = Math.round(interval * (0.5 + masteryLevel));
            
            return new Date(Date.now() + interval * 24 * 60 * 60 * 1000);
        }
        
        function updateLearningProgress(phraseKey, performance, responseTime) {
            const now = new Date().toISOString();
            
            if (!enhancedLearningData[phraseKey]) {
                // é¦–æ¬¡å­¦ä¹ 
                enhancedLearningData[phraseKey] = {
                    learned: true,
                    firstLearnedAt: now,
                    lastReviewedAt: now,
                    reviewCount: 1,
                    masteryLevel: performance,
                    difficulty: calculatePhraseDifficulty(phraseKey),
                    nextReviewAt: calculateNextReviewDate(1, performance, performance).toISOString(),
                    reviewHistory: []
                };
                
                // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡
                userStats.totalLearned++;
                updateConsecutiveDays();
                
                // è®°å½•å­¦ä¹ å†å²
                userStats.learningHistory.push({
                    date: now,
                    action: 'learned',
                    phraseKey: phraseKey,
                    result: performance >= 0.8 ? 'correct' : 'incorrect',
                    responseTime: responseTime || 3.0
                });
            } else {
                // å¤ä¹ 
                const data = enhancedLearningData[phraseKey];
                data.lastReviewedAt = now;
                data.reviewCount++;
                
                // æ›´æ–°ç†Ÿç»ƒåº¦
                if (performance >= 0.8) {
                    data.masteryLevel = Math.min(1, data.masteryLevel + 0.1);
                } else {
                    data.masteryLevel = Math.max(0, data.masteryLevel - 0.2);
                }
                
                // è®¡ç®—ä¸‹æ¬¡å¤ä¹ æ—¶é—´
                data.nextReviewAt = calculateNextReviewDate(
                    data.reviewCount, 
                    data.masteryLevel, 
                    performance
                ).toISOString();
                
                // è®°å½•å¤ä¹ å†å²
                userStats.learningHistory.push({
                    date: now,
                    action: 'reviewed',
                    phraseKey: phraseKey,
                    result: performance >= 0.8 ? 'correct' : 'incorrect',
                    responseTime: responseTime || 3.0
                });
            }
            
            // è®°å½•å­¦ä¹ å†å²
            enhancedLearningData[phraseKey].reviewHistory.push({
                date: now,
                result: performance >= 0.8 ? 'correct' : 'incorrect',
                responseTime: responseTime || 3.0,
                performance: performance
            });
            
            // ä¿æŒå‘åå…¼å®¹
            learnedPhrases[phraseKey] = true;
            
            // æ£€æŸ¥ç›®æ ‡å®Œæˆæƒ…å†µ
            checkGoalCompletion();
            
            saveLearnedPhrases();
        }
        
        function updateConsecutiveDays() {
            const today = new Date().toDateString();
            const lastStudy = userStats.lastStudyDate;
            
            if (lastStudy === today) {
                return; // ä»Šå¤©å·²ç»å­¦ä¹ è¿‡äº†
            }
            
            if (lastStudy) {
                const lastDate = new Date(lastStudy);
                const todayDate = new Date(today);
                const daysDiff = (todayDate - lastDate) / (1000 * 60 * 60 * 24);
                
                if (daysDiff === 1) {
                    userStats.consecutiveDays++;
                } else if (daysDiff > 1) {
                    userStats.consecutiveDays = 1; // é‡æ–°å¼€å§‹
                }
            } else {
                userStats.consecutiveDays = 1;
            }
            
            userStats.lastStudyDate = today;
        }
        
        // æˆå°±ç³»ç»Ÿ
        const achievements = {
            'first_steps': { 
                name: 'ğŸŒ± åˆå­¦è€…', 
                description: 'å­¦ä¼šç¬¬ä¸€ä¸ªçŸ­è¯­',
                condition: (stats) => stats.totalLearned >= 1 
            },
            'getting_started': { 
                name: 'ğŸš€ èµ·æ­¥è€…', 
                description: 'å­¦ä¼š5ä¸ªçŸ­è¯­',
                condition: (stats) => stats.totalLearned >= 5 
            },
            'dedicated_learner': { 
                name: 'ğŸ“š ä¸“æ³¨å­¦ä¹ è€…', 
                description: 'å­¦ä¼š20ä¸ªçŸ­è¯­',
                condition: (stats) => stats.totalLearned >= 20 
            },
            'week_warrior': { 
                name: 'âš¡ ä¸€å‘¨æˆ˜å£«', 
                description: 'è¿ç»­å­¦ä¹ 7å¤©',
                condition: (stats) => stats.consecutiveDays >= 7 
            },
            'month_master': { 
                name: 'ğŸ‘‘ æœˆåº¦å¤§å¸ˆ', 
                description: 'è¿ç»­å­¦ä¹ 30å¤©',
                condition: (stats) => stats.consecutiveDays >= 30 
            },
            'half_way_hero': { 
                name: 'ğŸ¯ åŠç¨‹è‹±é›„', 
                description: 'å­¦ä¼š150ä¸ªçŸ­è¯­',
                condition: (stats) => stats.totalLearned >= 150 
            },
            'completion_champion': { 
                name: 'ğŸ† å®Œæˆå† å†›', 
                description: 'å­¦ä¼šæ‰€æœ‰300ä¸ªçŸ­è¯­',
                condition: (stats) => stats.totalLearned >= 300 
            }
        };
        
        function checkAndShowAchievements() {
            const newAchievements = [];
            
            Object.entries(achievements).forEach(([key, achievement]) => {
                if (!userStats.unlockedAchievements.includes(key) && achievement.condition(userStats)) {
                    newAchievements.push({ key, ...achievement });
                    userStats.unlockedAchievements.push(key);
                }
            });
            
            if (newAchievements.length > 0) {
                showAchievementNotification(newAchievements);
                saveLearnedPhrases(); // ä¿å­˜æˆå°±
            }
        }
        
        function showAchievementNotification(achievements) {
            achievements.forEach((achievement, index) => {
                setTimeout(() => {
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-4 right-4 bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-all duration-500 max-w-sm';
                    notification.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="text-2xl">ğŸ‰</div>
                            <div>
                                <div class="font-bold text-lg">æ­å–œè·å¾—æˆå°±ï¼</div>
                                <div class="text-sm">${achievement.name}</div>
                                <div class="text-xs opacity-90">${achievement.description}</div>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    // åŠ¨ç”»æ˜¾ç¤º
                    setTimeout(() => {
                        notification.classList.remove('translate-x-full');
                    }, 100);
                    
                    // è‡ªåŠ¨éšè—
                    setTimeout(() => {
                        notification.classList.add('translate-x-full');
                        setTimeout(() => {
                            if (document.body.contains(notification)) {
                                document.body.removeChild(notification);
                            }
                        }, 500);
                    }, 4000);
                }, index * 1000); // å¤šä¸ªæˆå°±ä¾æ¬¡æ˜¾ç¤º
            });
        }

        function updateMainNavigationButtons() {
            categoryBrowseButton.classList.remove('active');
            learningHubButton.classList.remove('active');
            flashcardModeButton.classList.remove('active');

            if (currentMode === 'learning-hub') {
                learningHubButton.classList.add('active');
            } else if (currentMode === 'flashcard') {
                flashcardModeButton.classList.add('active');
            } else { // category-browse
                categoryBrowseButton.classList.add('active');
            }
        }

        function renderCategoryButtons() {
            categoryButtonsContainer.innerHTML = '';
            const categoryIcons = ['ğŸ‘‹', 'ğŸ ', 'ğŸ½ï¸', 'ğŸ‘', 'ğŸ®', 'ğŸ¤’', 'ğŸŒ³', 'ğŸ“–', 'ğŸ˜Š', 'ğŸ¨', 'ğŸ¾', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 'â“'];
            
            phrasesData.forEach((category, index) => {
                const button = document.createElement('button');
                button.innerHTML = `${categoryIcons[index] || 'ğŸ“'} ${category.category}`;
                button.classList.add('nav-button', 'py-3', 'px-4', 'sm:px-5', 'rounded-xl', 'text-sm', 'sm:text-base', 'font-medium', 'tooltip');
                button.setAttribute('data-tooltip', category.introduction);
                
                // æ·»åŠ å»¶è¿ŸåŠ¨ç”»
                button.style.animationDelay = `${index * 0.1}s`;
                button.classList.add('slide-in-left');
                
                button.addEventListener('click', () => {
                    // æ·»åŠ ç‚¹å‡»åé¦ˆ
                    button.classList.add('success-indicator');
                    setTimeout(() => button.classList.remove('success-indicator'), 600);
                    
                    currentCategoryIndex = index;
                    switchMode('category-browse');
                });
                
                // ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–
                button.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    button.style.transform = 'scale(0.95)';
                });
                
                button.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    button.style.transform = '';
                    button.click();
                });
                
                categoryButtonsContainer.appendChild(button);
            });
        }
        
        function updateActiveCategoryButton() {
            const buttons = categoryButtonsContainer.querySelectorAll('.nav-button');
            buttons.forEach((btn, idx) => {
                if (idx === currentCategoryIndex && currentMode === 'category-browse') {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function renderPhrases(phrasesToRender = null, targetContainer = phrasesContainer, categoryContext = null) {
            targetContainer.innerHTML = '';
            const phrases = phrasesToRender || phrasesData[currentCategoryIndex].phrases;
            const currentCategory = categoryContext || (phrasesToRender ? null : phrasesData[currentCategoryIndex].category);

            if (phrases.length === 0) {
                targetContainer.innerHTML = '<p class="text-center text-stone-500">æ­¤åˆ†ç±»ä¸‹æ²¡æœ‰çŸ­è¯­ã€‚</p>';
                return;
            }

            phrases.forEach((phrase) => {
                const card = document.createElement('div');
                card.classList.add('phrase-card', 'bg-white', 'p-4', 'rounded-lg', 'shadow-md', 'flex', 'flex-col', 'justify-between', 'min-h-[180px]', 'sm:min-h-[200px]');
                
                const phraseKey = `${currentCategory || 'GLOBAL'}_${phrase.en}`;
                const isLearned = learnedPhrases[phraseKey];

                card.innerHTML = `
                    <div class="flex-1">
                        <p class="text-lg sm:text-xl font-semibold text-sky-700 mb-3 leading-relaxed">${phrase.en}</p>
                        <p class="chinese-translation text-stone-600 text-base sm:text-lg hidden transition-all duration-300 ease-in-out transform translate-y-2 opacity-0">${phrase.zh}</p>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gradient-to-r from-sky-200 to-teal-200">
                        <div class="flex justify-between items-center gap-2">
                            <div class="flex items-center space-x-2">
                                <button class="toggle-translation-button action-button text-xs sm:text-sm px-3 py-2 rounded-lg tooltip" data-tooltip="æ˜¾ç¤º/éšè—ä¸­æ–‡ç¿»è¯‘">
                                    ğŸ”¤ ç¿»è¯‘
                                </button>
                                <button class="pronounce-button p-2 rounded-lg hover:bg-amber-100 group tooltip transition-all duration-200" data-tooltip="ç‚¹å‡»å¬å‘éŸ³">
                                    <svg class="speaker-icon w-5 h-5 sm:w-6 sm:h-6 text-teal-500 group-hover:text-teal-600 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                                </button>
                            </div>
                            <button class="mark-learned-button text-xs sm:text-sm px-3 py-2 rounded-lg border-2 transition-all duration-300 tooltip ${isLearned ? 'bg-gradient-to-r from-emerald-100 to-emerald-200 text-emerald-700 border-emerald-300 shadow-md' : 'border-stone-300 hover:bg-gradient-to-r hover:from-stone-50 hover:to-stone-100'}" data-tooltip="${isLearned ? 'ç‚¹å‡»å–æ¶ˆæ ‡è®°' : 'æ ‡è®°ä¸ºå·²å­¦'}">
                                ${isLearned ? 'âœ… å·²å­¦' : 'ğŸ“ æ ‡è®°'}
                            </button>
                        </div>
                    </div>
                `;

                const toggleButton = card.querySelector('.toggle-translation-button');
                const translationP = card.querySelector('.chinese-translation');
                toggleButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isHidden = translationP.classList.contains('hidden');
                    
                    if (isHidden) {
                        translationP.classList.remove('hidden', 'translate-y-2', 'opacity-0');
                        translationP.classList.add('translate-y-0', 'opacity-100');
                        toggleButton.innerHTML = 'ğŸ”¤ éšè—';
                        toggleButton.setAttribute('data-tooltip', 'éšè—ä¸­æ–‡ç¿»è¯‘');
                    } else {
                        translationP.classList.add('translate-y-2', 'opacity-0');
                        setTimeout(() => {
                            translationP.classList.add('hidden');
                            translationP.classList.remove('translate-y-0', 'opacity-100');
                        }, 300);
                        toggleButton.innerHTML = 'ğŸ”¤ ç¿»è¯‘';
                        toggleButton.setAttribute('data-tooltip', 'æ˜¾ç¤ºä¸­æ–‡ç¿»è¯‘');
                    }
                    
                    // æ·»åŠ æŒ‰é’®åé¦ˆåŠ¨ç”»
                    toggleButton.classList.add('success-indicator');
                    setTimeout(() => toggleButton.classList.remove('success-indicator'), 600);
                });

                const pronounceButton = card.querySelector('.pronounce-button');
                const speakerIcon = pronounceButton.querySelector('.speaker-icon');
                pronounceButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    
                    // é˜²æ­¢é‡å¤ç‚¹å‡»
                    if (speakerIcon.classList.contains('playing')) return;
                    
                    speakerIcon.classList.add('playing');
                    pronounceButton.classList.add('success-indicator');
                    
                    try {
                        if ('speechSynthesis' in window) {
                            // åœæ­¢ä¹‹å‰çš„è¯­éŸ³
                            speechSynthesis.cancel();
                            
                            const utterance = new SpeechSynthesisUtterance(phrase.en);
                            utterance.lang = 'en-US';
                            utterance.rate = 0.8; // ç¨æ…¢çš„è¯­é€Ÿï¼Œé€‚åˆå„¿ç«¥
                            utterance.pitch = 1.1; // ç¨é«˜çš„éŸ³è°ƒ
                            
                            utterance.onend = () => {
                                speakerIcon.classList.remove('playing');
                                pronounceButton.classList.remove('success-indicator');
                            };
                            
                            utterance.onerror = () => {
                                speakerIcon.classList.remove('playing');
                                pronounceButton.classList.remove('success-indicator');
                                pronounceButton.classList.add('error-shake');
                                setTimeout(() => pronounceButton.classList.remove('error-shake'), 500);
                            };
                            
                            speechSynthesis.speak(utterance);
                        } else {
                            throw new Error('Speech synthesis not supported');
                        }
                    } catch (error) {
                        console.warn('è¯­éŸ³æ’­æ”¾å¤±è´¥:', error);
                        speakerIcon.classList.remove('playing');
                        pronounceButton.classList.remove('success-indicator');
                        pronounceButton.classList.add('error-shake');
                        setTimeout(() => pronounceButton.classList.remove('error-shake'), 500);
                    }
                });
                
                const markLearnedButton = card.querySelector('.mark-learned-button');
                markLearnedButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const currentPhraseKey = `${currentCategory || 'GLOBAL'}_${phrase.en}`;
                    const wasLearned = learnedPhrases[currentPhraseKey];
                    
                    // æ·»åŠ ç‚¹å‡»åŠ¨ç”»
                    markLearnedButton.classList.add('success-indicator');
                    
                    if (wasLearned) {
                        // å–æ¶ˆæ ‡è®°
                        delete learnedPhrases[currentPhraseKey];
                        delete enhancedLearningData[currentPhraseKey];
                        
                        markLearnedButton.innerHTML = 'ğŸ“ æ ‡è®°';
                        markLearnedButton.classList.remove('bg-gradient-to-r', 'from-emerald-100', 'to-emerald-200', 'text-emerald-700', 'border-emerald-300', 'shadow-md');
                        markLearnedButton.classList.add('border-stone-300', 'hover:bg-gradient-to-r', 'hover:from-stone-50', 'hover:to-stone-100');
                        markLearnedButton.setAttribute('data-tooltip', 'æ ‡è®°ä¸ºå·²å­¦');
                        
                        userStats.totalLearned = Math.max(0, userStats.totalLearned - 1);
                    } else {
                        // æ ‡è®°ä¸ºå·²å­¦ - ä½¿ç”¨æ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ
                        const startTime = Date.now();
                        
                        // æ¨¡æ‹Ÿå­¦ä¹ è¡¨ç°ï¼ˆå®é™…åº”ç”¨ä¸­å¯ä»¥é€šè¿‡ç”¨æˆ·äº¤äº’è·å¾—ï¼‰
                        const performance = 0.8; // é»˜è®¤è‰¯å¥½è¡¨ç°
                        const responseTime = (Date.now() - startTime) / 1000;
                        
                        updateLearningProgress(currentPhraseKey, performance, responseTime);
                        
                        markLearnedButton.innerHTML = 'âœ… å·²å­¦';
                        markLearnedButton.classList.add('bg-gradient-to-r', 'from-emerald-100', 'to-emerald-200', 'text-emerald-700', 'border-emerald-300', 'shadow-md');
                        markLearnedButton.classList.remove('border-stone-300', 'hover:bg-gradient-to-r', 'hover:from-stone-50', 'hover:to-stone-100');
                        markLearnedButton.setAttribute('data-tooltip', 'ç‚¹å‡»å–æ¶ˆæ ‡è®°');
                        
                        // åº†ç¥åŠ¨ç”»
                        setTimeout(() => {
                            markLearnedButton.style.transform = 'scale(1.1)';
                            setTimeout(() => {
                                markLearnedButton.style.transform = '';
                            }, 200);
                        }, 100);
                        
                        // æ˜¾ç¤ºå­¦ä¹ æˆå°±
                        checkAndShowAchievements();
                    }
                    
                    setTimeout(() => markLearnedButton.classList.remove('success-indicator'), 600);
                });

                targetContainer.appendChild(card);
            });
        }

        function loadFlashcardSet() {
            let source = document.querySelector('input[name="flashcard-source"]:checked').value;
            flashcardSet = [];

            if (source === 'all') {
                flashcardSet = [...allFlattenedPhrases];
            } else if (source === 'category') {
                flashcardSet = [...phrasesData[currentCategoryIndex].phrases];
            } else if (source === 'unlearned') {
                flashcardSet = allFlattenedPhrases.filter(phrase => !learnedPhrases[`GLOBAL_${phrase.en}`]);
            }
            
            for (let i = flashcardSet.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [flashcardSet[i], flashcardSet[j]] = [flashcardSet[j], flashcardSet[i]];
            }

            currentFlashcardIndex = 0;
        }


        function renderFlashcard() {
            flashcardDisplayArea.innerHTML = '';
            // flashcardAssessmentButtons.classList.add('hidden'); // Removed assessment buttons
            // flashcardNavButtons.classList.remove('hidden'); // Always visible now

            if (flashcardSet.length === 0) {
                flashcardDisplayArea.innerHTML = '<p class="text-center text-stone-500 py-10">å½“å‰æ¥æºæ²¡æœ‰çŸ­è¯­å¯ä¾›å­¦ä¹ ã€‚</p>';
                flashcardCounter.textContent = '0 / 0';
                return;
            }

            const phrase = flashcardSet[currentFlashcardIndex];
            
            const flashcardDiv = document.createElement('div');
            flashcardDiv.classList.add('flashcard', 'h-64', 'sm:h-80', 'max-w-md', 'mx-auto');
            flashcardDiv.innerHTML = `
                <div class="flashcard-inner">
                    <div class="flashcard-front text-2xl sm:text-3xl font-semibold text-sky-700 flex flex-col justify-center items-center">
                        <p>${phrase.en}</p>
                        <button class="pronounce-button mt-4 p-2 rounded-full hover:bg-amber-100 group">
                            <svg class="speaker-icon w-6 h-6 sm:w-7 sm:h-7 text-teal-500 group-hover:text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                        </button>
                    </div>
                    <div class="flashcard-back text-xl sm:text-2xl font-semibold text-emerald-700 flex flex-col justify-center items-center">
                        <p>${phrase.zh}</p>
                        <button class="pronounce-button mt-4 p-2 rounded-full hover:bg-amber-100 group">
                            <svg class="speaker-icon w-6 h-6 sm:w-7 sm:h-7 text-teal-500 group-hover:text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                        </button>
                    </div>
                </div>
            `;

            const flashcardInner = flashcardDiv.querySelector('.flashcard-inner');
            
            // Add click listener to the flashcardDiv (the outer container) for flipping
            flashcardDiv.addEventListener('click', (event) => {
                // If the clicked element or any of its parents is a pronounce button, do not flip the card.
                if (event.target.closest('.pronounce-button')) {
                    return;
                }
                
                // Toggle the 'flipped' class to trigger the 3D flip effect
                flashcardInner.classList.toggle('flipped');
            });
            
            flashcardDisplayArea.appendChild(flashcardDiv);

            const pronounceButtons = flashcardDiv.querySelectorAll('.pronounce-button');
            pronounceButtons.forEach(button => {
                const speakerIcon = button.querySelector('.speaker-icon');
                button.addEventListener('click', (event) => {
                    event.stopPropagation(); // Crucial: Stop click from bubbling up to flip the card
                    speakerIcon.classList.add('playing');
                    setTimeout(() => speakerIcon.classList.remove('playing'), 1000);

                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(phrase.en);
                        utterance.lang = 'en-US';
                        speechSynthesis.speak(utterance);
                    } else {
                        console.warn('Web Speech API is not supported in this browser.');
                    }
                });
            });

            updateFlashcardCounter();
            updateMarkLearnedFlashcardButtonState(); // Update button state when card renders
        }

        function updateFlashcardCounter() {
            flashcardCounter.textContent = `${flashcardSet.length > 0 ? currentFlashcardIndex + 1 : 0} / ${flashcardSet.length}`;
        }

        function updateMarkLearnedFlashcardButtonState() {
            if (flashcardSet.length > 0) {
                const currentPhrase = flashcardSet[currentFlashcardIndex];
                const phraseKey = `GLOBAL_${currentPhrase.en}`;
                if (learnedPhrases[phraseKey]) {
                    markLearnedFlashcardButton.innerHTML = 'âœ” å·²å­¦';
                    markLearnedFlashcardButton.classList.add('bg-emerald-500', 'hover:bg-emerald-600');
                    markLearnedFlashcardButton.classList.remove('bg-sky-600', 'hover:bg-sky-700');
                } else {
                    markLearnedFlashcardButton.innerHTML = 'æ ‡è®°å·²å­¦';
                    markLearnedFlashcardButton.classList.remove('bg-emerald-500', 'hover:bg-emerald-600');
                    markLearnedFlashcardButton.classList.add('bg-sky-600', 'hover:bg-sky-700');
                }
            } else {
                 markLearnedFlashcardButton.innerHTML = 'æ ‡è®°å·²å­¦'; // Default state if no cards
                 markLearnedFlashcardButton.classList.remove('bg-emerald-500', 'hover:bg-emerald-600');
                 markLearnedFlashcardButton.classList.add('bg-sky-600', 'hover:bg-sky-700');
            }
        }

        function showNextFlashcard() {
            if (flashcardSet.length === 0) return;

            if (currentFlashcardIndex < flashcardSet.length - 1) {
                currentFlashcardIndex++;
            } else {
                currentFlashcardIndex = 0; // Loop back to start
            }
            renderFlashcard();
            const currentCardInner = flashcardDisplayArea.querySelector('.flashcard-inner');
            if (currentCardInner) {
                currentCardInner.classList.remove('flipped'); // Ensure new card starts unflipped
            }
        }

        function showPrevFlashcard() {
            if (flashcardSet.length === 0) return;

            if (currentFlashcardIndex > 0) {
                currentFlashcardIndex--;
            } else {
                currentFlashcardIndex = flashcardSet.length - 1;
            }
            renderFlashcard();
            const currentCardInner = flashcardDisplayArea.querySelector('.flashcard-inner');
            if (currentCardInner) {
                currentCardInner.classList.remove('flipped'); // Ensure new card starts unflipped
            }
        }


        function renderLearningPlan() {
            const totalDays = Math.ceil(allFlattenedPhrases.length / phrasesPerDay);
            currentDayDisplay.textContent = `ç¬¬ ${currentLearningDay + 1} å¤© / å…± ${totalDays} å¤©`;
            categoryIntro.textContent = "";

            const startIndex = currentLearningDay * phrasesPerDay;
            const endIndex = Math.min(startIndex + phrasesPerDay, allFlattenedPhrases.length);
            const dailyPhrases = allFlattenedPhrases.slice(startIndex, endIndex);

            if (dailyPhrases.length === 0) {
                dailyPhrasesDisplay.innerHTML = '<p class="text-center text-stone-500">æ­å–œæ‚¨ï¼æ‰€æœ‰çŸ­è¯­éƒ½å·²åœ¨å­¦ä¹ è®¡åˆ’ä¸­å±•ç¤ºå®Œæ¯•ã€‚</p>';
            } else {
                renderPhrases(dailyPhrases, dailyPhrasesDisplay, 'GLOBAL');
            }
        }

        function generateUnlearnedPhrasesForReview() {
            // ä½¿ç”¨æ™ºèƒ½å¤ä¹ ç®—æ³•
            const reviewQueue = generateSmartReviewQueue();
            
            if (reviewQueue.length > 0) {
                // æœ‰éœ€è¦å¤ä¹ çš„å†…å®¹
                unlearnedPhrasesForReview = reviewQueue.map(item => {
                    const phraseKey = item.key.replace('GLOBAL_', '');
                    return allFlattenedPhrases.find(p => p.en === phraseKey);
                }).filter(p => p); // è¿‡æ»¤æ‰æ‰¾ä¸åˆ°çš„çŸ­è¯­
            } else {
                // æ²¡æœ‰éœ€è¦å¤ä¹ çš„ï¼Œæ˜¾ç¤ºæœªå­¦ä¹ çš„
                unlearnedPhrasesForReview = allFlattenedPhrases.filter(phrase => {
                    return !learnedPhrases[`GLOBAL_${phrase.en}`];
                });
                
                // æŒ‰éš¾åº¦æ’åºï¼Œè€Œä¸æ˜¯éšæœº
                unlearnedPhrasesForReview.sort((a, b) => {
                    const diffA = calculatePhraseDifficulty(`GLOBAL_${a.en}`);
                    const diffB = calculatePhraseDifficulty(`GLOBAL_${b.en}`);
                    return diffA - diffB;
                });
            }
        }
        
        function generateSmartReviewQueue() {
            const now = new Date();
            const reviewQueue = [];
            
            Object.entries(enhancedLearningData).forEach(([key, data]) => {
                if (data.learned && new Date(data.nextReviewAt) <= now) {
                    const priority = calculateReviewPriority(data, now);
                    reviewQueue.push({ key, data, priority });
                }
            });
            
            // æŒ‰ä¼˜å…ˆçº§æ’åº
            return reviewQueue.sort((a, b) => b.priority - a.priority);
        }
        
        function calculateReviewPriority(data, now) {
            const overdueDays = Math.max(0, (now - new Date(data.nextReviewAt)) / (24 * 60 * 60 * 1000));
            const forgettingRisk = 1 - data.masteryLevel;
            const importance = 1 - data.difficulty; // ç®€å•çš„çŸ­è¯­æ›´é‡è¦
            
            return (1 + overdueDays) * forgettingRisk * importance;
        }

        function renderReviewPlan() {
            const phrasesInReviewSet = 9;
            const totalReviewSets = Math.ceil(unlearnedPhrasesForReview.length / phrasesInReviewSet);
            
            // æ£€æŸ¥æ˜¯å¦æœ‰éœ€è¦å¤ä¹ çš„å†…å®¹
            const reviewQueue = generateSmartReviewQueue();
            const hasReviewItems = reviewQueue.length > 0;
            
            if (hasReviewItems) {
                categoryIntro.textContent = `æ™ºèƒ½å¤ä¹ : ç¬¬ ${currentReviewSetIndex + 1} é¡µ / å…± ${totalReviewSets} é¡µ (${unlearnedPhrasesForReview.length} ä¸ªéœ€è¦å¤ä¹ çš„çŸ­è¯­)`;
            } else {
                categoryIntro.textContent = `å­¦ä¹ æ–°å†…å®¹: ç¬¬ ${currentReviewSetIndex + 1} é¡µ / å…± ${totalReviewSets} é¡µ (${unlearnedPhrasesForReview.length} ä¸ªæœªå­¦çŸ­è¯­)`;
            }

            if (unlearnedPhrasesForReview.length === 0) {
                if (hasReviewItems) {
                    reviewPhrasesDisplay.innerHTML = '<p class="text-center text-stone-500 text-lg py-10">ğŸ‰ å¤ªæ£’äº†ï¼å½“å‰æ²¡æœ‰éœ€è¦å¤ä¹ çš„çŸ­è¯­ï¼</p>';
                } else {
                    reviewPhrasesDisplay.innerHTML = '<p class="text-center text-stone-500 text-lg py-10">ğŸ‰ æ­å–œï¼æ‚¨å·²ç»æŒæ¡äº†æ‰€æœ‰çŸ­è¯­ï¼Œå¤ªæ£’äº†ï¼</p>';
                }
                return;
            }

            const startIndex = currentReviewSetIndex * phrasesInReviewSet;
            const endIndex = Math.min(startIndex + phrasesInReviewSet, unlearnedPhrasesForReview.length);
            const currentSetPhrases = unlearnedPhrasesForReview.slice(startIndex, endIndex);

            renderPhrases(currentSetPhrases, reviewPhrasesDisplay, 'GLOBAL');
            
            // æ·»åŠ å¤ä¹ æç¤º
            if (hasReviewItems && currentReviewSetIndex === 0) {
                addReviewTips();
            }
        }
        
        function addReviewTips() {
            const existingTips = document.getElementById('review-tips');
            if (existingTips) {
                existingTips.remove();
            }
            
            const tipsContainer = document.createElement('div');
            tipsContainer.id = 'review-tips';
            tipsContainer.className = 'bg-blue-50 border-l-4 border-blue-400 p-4 mb-4 rounded-r-lg';
            tipsContainer.innerHTML = `
                <div class="flex items-start">
                    <div class="text-blue-400 mr-3 text-xl">ğŸ’¡</div>
                    <div>
                        <h4 class="text-blue-800 font-semibold mb-2">æ™ºèƒ½å¤ä¹ æç¤º</h4>
                        <p class="text-blue-700 text-sm">
                            è¿™äº›çŸ­è¯­æ˜¯æ ¹æ®æ‚¨çš„å­¦ä¹ æƒ…å†µå’Œé—å¿˜æ›²çº¿æ™ºèƒ½æ¨èçš„ã€‚
                            å®šæœŸå¤ä¹ å¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°è®°ä½å·²å­¦å†…å®¹ï¼
                        </p>
                    </div>
                </div>
            `;
            
            reviewPhrasesDisplay.parentNode.insertBefore(tipsContainer, reviewPhrasesDisplay);
        }

        function updateMyProgress() {
            let totalPhrases = allFlattenedPhrases.length;
            let learnedCount = userStats.totalLearned;
            const percentage = totalPhrases === 0 ? 0 : Math.round((learnedCount / totalPhrases) * 100);

            totalPhrasesCount.textContent = totalPhrases;
            learnedPhrasesCount.textContent = learnedCount;
            progressPercentage.textContent = percentage;
            progressBarFill.style.width = `${percentage}%`;

            // æ›´æ–°è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
            updateDetailedStats();
            
            // æ›´æ–°åˆ†ç±»è¿›åº¦
            categoryProgressDisplay.innerHTML = '';
            phrasesData.forEach(category => {
                let categoryLearnedCount = 0;
                let categoryMasterySum = 0;
                
                category.phrases.forEach(phrase => {
                    const phraseKey = `GLOBAL_${phrase.en}`;
                    if (learnedPhrases[phraseKey]) { 
                        categoryLearnedCount++;
                        const enhancedData = enhancedLearningData[phraseKey];
                        if (enhancedData) {
                            categoryMasterySum += enhancedData.masteryLevel;
                        }
                    }
                });
                
                const categoryPercentage = category.phrases.length === 0 ? 0 : Math.round((categoryLearnedCount / category.phrases.length) * 100);
                const avgMastery = categoryLearnedCount === 0 ? 0 : Math.round((categoryMasterySum / categoryLearnedCount) * 100);

                const categoryProgressCard = document.createElement('div');
                categoryProgressCard.classList.add('bg-stone-100', 'p-3', 'rounded-lg', 'shadow-sm');
                categoryProgressCard.innerHTML = `
                    <p class="font-semibold text-stone-800">${category.category}: ${categoryLearnedCount} / ${category.phrases.length} å¥</p>
                    <div class="w-full bg-stone-300 rounded-full h-2 mt-1">
                        <div class="bg-blue-500 h-full rounded-full" style="width: ${categoryPercentage}%;"></div>
                    </div>
                    ${categoryLearnedCount > 0 ? `<p class="text-xs text-stone-600 mt-1">å¹³å‡ç†Ÿç»ƒåº¦: ${avgMastery}%</p>` : ''}
                `;
                categoryProgressDisplay.appendChild(categoryProgressCard);
            });
            
            // æ˜¾ç¤ºæˆå°±
            displayAchievements();
        }
        
        function updateDetailedStats() {
            // åœ¨è¿›åº¦é¡µé¢æ·»åŠ è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
            const existingStats = document.getElementById('detailed-stats');
            if (existingStats) {
                existingStats.remove();
            }
            
            const statsContainer = document.createElement('div');
            statsContainer.id = 'detailed-stats';
            statsContainer.className = 'bg-gradient-to-r from-blue-50 to-teal-50 p-4 rounded-lg mb-6';
            
            // è®¡ç®—éœ€è¦å¤ä¹ çš„çŸ­è¯­æ•°é‡
            const reviewQueue = generateSmartReviewQueue();
            const needReview = reviewQueue.length;
            
            // è®¡ç®—å¹³å‡ç†Ÿç»ƒåº¦
            const learnedData = Object.values(enhancedLearningData).filter(data => data.learned);
            const avgMastery = learnedData.length === 0 ? 0 : 
                Math.round((learnedData.reduce((sum, data) => sum + data.masteryLevel, 0) / learnedData.length) * 100);
            
            statsContainer.innerHTML = `
                <h4 class="text-lg font-semibold text-teal-700 mb-3">ğŸ“Š è¯¦ç»†ç»Ÿè®¡</h4>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600">${userStats.consecutiveDays}</div>
                        <div class="text-xs text-stone-600">è¿ç»­å¤©æ•°</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-2xl font-bold text-green-600">${avgMastery}%</div>
                        <div class="text-xs text-stone-600">å¹³å‡ç†Ÿç»ƒåº¦</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-2xl font-bold text-orange-600">${needReview}</div>
                        <div class="text-xs text-stone-600">å¾…å¤ä¹ </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-2xl font-bold text-purple-600">${userStats.unlockedAchievements.length}</div>
                        <div class="text-xs text-stone-600">è·å¾—æˆå°±</div>
                    </div>
                </div>
            `;
            
            // æ’å…¥åˆ°è¿›åº¦ç™¾åˆ†æ¯”åé¢
            const progressSection = document.querySelector('#my-progress-content .flex.flex-col.items-center');
            progressSection.parentNode.insertBefore(statsContainer, progressSection.nextSibling);
        }
        
        function displayAchievements() {
            // æ˜¾ç¤ºå·²è·å¾—çš„æˆå°±
            const existingAchievements = document.getElementById('achievements-display');
            if (existingAchievements) {
                existingAchievements.remove();
            }
            
            if (userStats.unlockedAchievements.length === 0) return;
            
            const achievementsContainer = document.createElement('div');
            achievementsContainer.id = 'achievements-display';
            achievementsContainer.className = 'mt-6';
            achievementsContainer.innerHTML = `
                <h4 class="text-lg font-semibold text-sky-600 mb-3 text-center">ğŸ† æˆ‘çš„æˆå°±</h4>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                    ${userStats.unlockedAchievements.map(key => {
                        const achievement = achievements[key];
                        return `
                            <div class="bg-gradient-to-r from-yellow-100 to-orange-100 p-3 rounded-lg text-center border-2 border-yellow-300">
                                <div class="text-lg mb-1">${achievement.name}</div>
                                <div class="text-xs text-stone-600">${achievement.description}</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            categoryProgressDisplay.parentNode.appendChild(achievementsContainer);
        }
        
        // ä»Šæ—¥å­¦ä¹ ç»Ÿè®¡æ›´æ–°
        function updateTodayStats() {
            const today = new Date().toDateString();
            const todayLearned = getTodayLearnedCount();
            const reviewQueue = generateSmartReviewQueue();
            
            document.getElementById('today-target').textContent = userStats.dailyTarget;
            document.getElementById('today-completed').textContent = todayLearned;
            document.getElementById('today-review').textContent = reviewQueue.length;
            document.getElementById('study-streak').textContent = userStats.consecutiveDays;
            
            const progressPercent = Math.round((todayLearned / userStats.dailyTarget) * 100);
            document.getElementById('today-progress-text').textContent = `${progressPercent}%`;
            document.getElementById('today-progress-bar').style.width = `${Math.min(100, progressPercent)}%`;
        }
        
        function getTodayLearnedCount() {
            const today = new Date().toDateString();
            return userStats.learningHistory.filter(entry => 
                new Date(entry.date).toDateString() === today && entry.action === 'learned'
            ).length;
        }
        
        // å­¦ä¹ æ¨¡å¼ç®¡ç†
        function setupLearningModeSelection() {
            const modeOptions = document.querySelectorAll('.learning-mode-option');
            modeOptions.forEach(option => {
                const radio = option.querySelector('input[type="radio"]');
                const container = option.querySelector('div');
                
                option.addEventListener('click', () => {
                    // æ›´æ–°UI
                    modeOptions.forEach(opt => {
                        opt.querySelector('div').classList.remove('border-blue-400', 'bg-blue-50');
                        opt.querySelector('div').classList.add('border-stone-200');
                    });
                    
                    container.classList.remove('border-stone-200');
                    container.classList.add('border-blue-400', 'bg-blue-50');
                    radio.checked = true;
                    
                    // æ›´æ–°å­¦ä¹ æ¨¡å¼
                    userStats.learningMode = radio.value;
                    updateDailyTargetByMode();
                    saveLearnedPhrases();
                });
            });
        }
        
        function updateDailyTargetByMode() {
            const modeTargets = {
                'beginner': 3,
                'normal': 5,
                'intensive': 8
            };
            
            userStats.dailyTarget = modeTargets[userStats.learningMode] || 5;
            document.getElementById('phrases-per-day-input').value = userStats.dailyTarget;
            phrasesPerDay = userStats.dailyTarget;
        }
        
        // æ™ºèƒ½è§„åˆ’åŠŸèƒ½
        function generateSmartPlan() {
            const userAbility = assessUserAbility();
            const recommendations = generateRecommendations(userAbility);
            
            showSmartPlanDialog(recommendations);
        }
        
        function assessUserAbility() {
            const recentHistory = userStats.learningHistory.slice(-20);
            if (recentHistory.length === 0) {
                return { level: 'beginner', confidence: 0.5 };
            }
            
            const avgAccuracy = recentHistory.filter(h => h.result === 'correct').length / recentHistory.length;
            const avgResponseTime = recentHistory.reduce((sum, h) => sum + (h.responseTime || 3), 0) / recentHistory.length;
            
            let level = 'normal';
            if (avgAccuracy > 0.9 && avgResponseTime < 2) {
                level = 'intensive';
            } else if (avgAccuracy < 0.7 || avgResponseTime > 4) {
                level = 'beginner';
            }
            
            return { level, accuracy: avgAccuracy, responseTime: avgResponseTime };
        }
        
        function generateRecommendations(ability) {
            const recommendations = [];
            
            if (ability.level === 'intensive') {
                recommendations.push('å»ºè®®åˆ‡æ¢åˆ°å¼ºåŒ–æ¨¡å¼ï¼Œæ¯å¤©å­¦ä¹ 8ä¸ªçŸ­è¯­');
                recommendations.push('å¯ä»¥å°è¯•æ›´éš¾çš„çŸ­è¯­åˆ†ç±»');
            } else if (ability.level === 'beginner') {
                recommendations.push('å»ºè®®åˆ‡æ¢åˆ°åˆå­¦è€…æ¨¡å¼ï¼Œæ¯å¤©å­¦ä¹ 3ä¸ªçŸ­è¯­');
                recommendations.push('å¤šèŠ±æ—¶é—´åœ¨å¤ä¹ ä¸Šï¼Œå·©å›ºå·²å­¦å†…å®¹');
            } else {
                recommendations.push('å½“å‰å­¦ä¹ èŠ‚å¥å¾ˆå¥½ï¼Œä¿æŒæ ‡å‡†æ¨¡å¼');
                recommendations.push('å¯ä»¥é€‚å½“å¢åŠ å­¦ä¹ é‡æˆ–å°è¯•æ–°çš„åˆ†ç±»');
            }
            
            return recommendations;
        }
        
        function showSmartPlanDialog(recommendations) {
            const dialog = document.createElement('div');
            dialog.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            dialog.innerHTML = `
                <div class="bg-white p-6 rounded-lg max-w-md mx-4">
                    <h3 class="text-lg font-bold text-sky-600 mb-4">ğŸ¤– æ™ºèƒ½å­¦ä¹ å»ºè®®</h3>
                    <div class="space-y-2 mb-4">
                        ${recommendations.map(rec => `<p class="text-sm text-stone-600">â€¢ ${rec}</p>`).join('')}
                    </div>
                    <div class="flex gap-2">
                        <button class="accept-plan flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg">é‡‡çº³å»ºè®®</button>
                        <button class="cancel-plan flex-1 bg-stone-300 text-stone-700 py-2 px-4 rounded-lg">æš‚ä¸é‡‡çº³</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            dialog.querySelector('.accept-plan').addEventListener('click', () => {
                // åº”ç”¨å»ºè®®
                const ability = assessUserAbility();
                userStats.learningMode = ability.level;
                updateDailyTargetByMode();
                updateTodayStats();
                document.body.removeChild(dialog);
                showSuccessMessage('å·²åº”ç”¨æ™ºèƒ½å­¦ä¹ å»ºè®®ï¼');
            });
            
            dialog.querySelector('.cancel-plan').addEventListener('click', () => {
                document.body.removeChild(dialog);
            });
        }
        
        // å­¦ä¹ ç›®æ ‡ç®¡ç†
        function renderLearningGoals() {
            renderCurrentGoals();
            renderCompletedGoals();
        }
        
        function renderCurrentGoals() {
            const container = document.getElementById('current-goals-display');
            const activeGoals = userStats.goals.filter(goal => !goal.completed);
            
            if (activeGoals.length === 0) {
                container.innerHTML = '<p class="text-stone-500 text-center py-4">æš‚æ— æ´»è·ƒç›®æ ‡ï¼Œè®¾å®šä¸€ä¸ªæ–°ç›®æ ‡å¼€å§‹å§ï¼</p>';
                return;
            }
            
            container.innerHTML = activeGoals.map(goal => {
                const progress = calculateGoalProgress(goal);
                const progressPercent = Math.round((progress.current / progress.target) * 100);
                
                return `
                    <div class="bg-white p-4 rounded-lg border-l-4 border-purple-400 mb-3">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-stone-800">${goal.description}</h4>
                            <button class="text-red-500 hover:text-red-700 text-sm" onclick="removeGoal('${goal.id}')">åˆ é™¤</button>
                        </div>
                        <div class="text-sm text-stone-600 mb-2">${goal.type} â€¢ ç›®æ ‡: ${progress.target}</div>
                        <div class="flex justify-between text-sm text-stone-600 mb-1">
                            <span>è¿›åº¦: ${progress.current} / ${progress.target}</span>
                            <span>${progressPercent}%</span>
                        </div>
                        <div class="w-full bg-stone-200 rounded-full h-2">
                            <div class="bg-purple-500 h-full rounded-full transition-all duration-300" style="width: ${Math.min(100, progressPercent)}%;"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function renderCompletedGoals() {
            const container = document.getElementById('completed-goals-display');
            const completedGoals = userStats.goals.filter(goal => goal.completed);
            
            if (completedGoals.length === 0) {
                container.innerHTML = '<p class="text-stone-500 text-center py-4">è¿˜æ²¡æœ‰å®Œæˆçš„ç›®æ ‡ï¼Œç»§ç»­åŠªåŠ›ï¼</p>';
                return;
            }
            
            container.innerHTML = completedGoals.slice(-5).map(goal => `
                <div class="bg-white p-3 rounded-lg border-l-4 border-green-400 mb-2">
                    <div class="font-medium text-stone-800">${goal.description}</div>
                    <div class="text-sm text-stone-600">å®Œæˆäº: ${new Date(goal.completedAt).toLocaleDateString()}</div>
                </div>
            `).join('');
        }
        
        function addNewGoal() {
            const type = document.getElementById('goal-type-select').value;
            const value = parseInt(document.getElementById('goal-value-input').value);
            const description = document.getElementById('goal-description-input').value;
            
            if (!description.trim()) {
                showErrorMessage('è¯·è¾“å…¥ç›®æ ‡æè¿°');
                return;
            }
            
            const goal = {
                id: Date.now().toString(),
                type: type,
                value: value,
                description: description,
                createdAt: new Date().toISOString(),
                completed: false
            };
            
            userStats.goals.push(goal);
            saveLearnedPhrases();
            renderLearningGoals();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('goal-description-input').value = '';
            document.getElementById('goal-value-input').value = '10';
            
            showSuccessMessage('ç›®æ ‡æ·»åŠ æˆåŠŸï¼');
        }
        
        function calculateGoalProgress(goal) {
            const today = new Date().toDateString();
            const thisWeek = getWeekStart(new Date());
            
            switch (goal.type) {
                case 'daily':
                    return {
                        current: getTodayLearnedCount(),
                        target: goal.value
                    };
                case 'weekly':
                    return {
                        current: getWeekLearnedCount(thisWeek),
                        target: goal.value
                    };
                case 'total':
                    return {
                        current: userStats.totalLearned,
                        target: goal.value
                    };
                case 'streak':
                    return {
                        current: userStats.consecutiveDays,
                        target: goal.value
                    };
                default:
                    return { current: 0, target: goal.value };
            }
        }
        
        function getWeekLearnedCount(weekStart) {
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekEnd.getDate() + 7);
            
            return userStats.learningHistory.filter(entry => {
                const entryDate = new Date(entry.date);
                return entryDate >= weekStart && entryDate < weekEnd && entry.action === 'learned';
            }).length;
        }
        
        function getWeekStart(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day;
            return new Date(d.setDate(diff));
        }
        
        window.removeGoal = function(goalId) {
            userStats.goals = userStats.goals.filter(goal => goal.id !== goalId);
            saveLearnedPhrases();
            renderLearningGoals();
            showSuccessMessage('ç›®æ ‡å·²åˆ é™¤');
        }
        
        function checkGoalCompletion() {
            userStats.goals.forEach(goal => {
                if (!goal.completed) {
                    const progress = calculateGoalProgress(goal);
                    if (progress.current >= progress.target) {
                        goal.completed = true;
                        goal.completedAt = new Date().toISOString();
                        showGoalCompletionNotification(goal);
                    }
                }
            });
        }
        
        function showGoalCompletionNotification(goal) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-all duration-500 max-w-sm';
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="text-2xl">ğŸ¯</div>
                    <div>
                        <div class="font-bold text-lg">ç›®æ ‡è¾¾æˆï¼</div>
                        <div class="text-sm">${goal.description}</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.remove('translate-x-full'), 100);
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 4000);
        }
        
        // å­¦ä¹ æ´å¯Ÿåˆ†æ
        function renderLearningInsights() {
            renderLearningPatterns();
            renderPersonalizedSuggestions();
            renderEfficiencyAnalysis();
            renderLearningPredictions();
        }
        
        function renderLearningPatterns() {
            const container = document.getElementById('learning-patterns-display');
            const patterns = analyzeLearningPatterns();
            
            container.innerHTML = `
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-lg font-bold text-indigo-600">${patterns.bestTimeOfDay || 'æš‚æ— æ•°æ®'}</div>
                        <div class="text-sm text-stone-600">æœ€ä½³å­¦ä¹ æ—¶é—´</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-lg font-bold text-indigo-600">${patterns.averageSessionLength}åˆ†é’Ÿ</div>
                        <div class="text-sm text-stone-600">å¹³å‡å­¦ä¹ æ—¶é•¿</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-lg font-bold text-indigo-600">${patterns.strongestCategory || 'æš‚æ— æ•°æ®'}</div>
                        <div class="text-sm text-stone-600">æœ€å¼ºåˆ†ç±»</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="text-lg font-bold text-indigo-600">${patterns.learningStreak}å¤©</div>
                        <div class="text-sm text-stone-600">æœ€é•¿è¿ç»­å­¦ä¹ </div>
                    </div>
                </div>
            `;
        }
        
        function renderPersonalizedSuggestions() {
            const container = document.getElementById('personalized-suggestions-display');
            const suggestions = generatePersonalizedSuggestions();
            
            container.innerHTML = suggestions.map(suggestion => `
                <div class="bg-white p-3 rounded-lg mb-2 border-l-4 border-orange-400">
                    <div class="font-medium text-stone-800">${suggestion.title}</div>
                    <div class="text-sm text-stone-600">${suggestion.description}</div>
                </div>
            `).join('');
        }
        
        function renderEfficiencyAnalysis() {
            const container = document.getElementById('efficiency-analysis-display');
            const efficiency = analyzeEfficiency();
            
            container.innerHTML = `
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="bg-white p-3 rounded-lg text-center">
                        <div class="text-2xl font-bold text-teal-600">${efficiency.accuracy}%</div>
                        <div class="text-sm text-stone-600">å­¦ä¹ å‡†ç¡®ç‡</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg text-center">
                        <div class="text-2xl font-bold text-teal-600">${efficiency.speed}s</div>
                        <div class="text-sm text-stone-600">å¹³å‡å“åº”æ—¶é—´</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg text-center">
                        <div class="text-2xl font-bold text-teal-600">${efficiency.retention}%</div>
                        <div class="text-sm text-stone-600">è®°å¿†ä¿æŒç‡</div>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-white rounded-lg">
                    <div class="text-sm text-stone-700">${efficiency.analysis}</div>
                </div>
            `;
        }
        
        function renderLearningPredictions() {
            const container = document.getElementById('learning-predictions-display');
            const predictions = generateLearningPredictions();
            
            container.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg">
                        <div class="font-medium text-stone-800">å®Œæˆæ‰€æœ‰çŸ­è¯­é¢„è®¡æ—¶é—´</div>
                        <div class="text-lg text-pink-600">${predictions.completionTime}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="font-medium text-stone-800">å»ºè®®ä¸‹å‘¨å­¦ä¹ é‡ç‚¹</div>
                        <div class="text-sm text-stone-600">${predictions.nextWeekFocus}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg">
                        <div class="font-medium text-stone-800">å­¦ä¹ è¶‹åŠ¿</div>
                        <div class="text-sm text-stone-600">${predictions.trend}</div>
                    </div>
                </div>
            `;
        }
        
        function analyzeLearningPatterns() {
            const history = userStats.learningHistory;
            if (history.length === 0) {
                return {
                    bestTimeOfDay: null,
                    averageSessionLength: 0,
                    strongestCategory: null,
                    learningStreak: userStats.consecutiveDays
                };
            }
            
            // åˆ†ææœ€ä½³å­¦ä¹ æ—¶é—´
            const timeStats = {};
            history.forEach(entry => {
                const hour = new Date(entry.date).getHours();
                const timeSlot = hour < 12 ? 'ä¸Šåˆ' : hour < 18 ? 'ä¸‹åˆ' : 'æ™šä¸Š';
                timeStats[timeSlot] = (timeStats[timeSlot] || 0) + 1;
            });
            
            const bestTimeOfDay = Object.keys(timeStats).reduce((a, b) => 
                timeStats[a] > timeStats[b] ? a : b, null);
            
            return {
                bestTimeOfDay,
                averageSessionLength: Math.round(userStats.totalStudyTime / Math.max(1, userStats.consecutiveDays)),
                strongestCategory: findStrongestCategory(),
                learningStreak: userStats.consecutiveDays
            };
        }
        
        function findStrongestCategory() {
            const categoryStats = {};
            phrasesData.forEach(category => {
                let learned = 0;
                category.phrases.forEach(phrase => {
                    if (learnedPhrases[`GLOBAL_${phrase.en}`]) learned++;
                });
                categoryStats[category.category] = learned / category.phrases.length;
            });
            
            return Object.keys(categoryStats).reduce((a, b) => 
                categoryStats[a] > categoryStats[b] ? a : b, null);
        }
        
        function generatePersonalizedSuggestions() {
            const suggestions = [];
            const accuracy = userStats.averageAccuracy;
            const streak = userStats.consecutiveDays;
            
            if (accuracy < 0.7) {
                suggestions.push({
                    title: 'æ”¾æ…¢å­¦ä¹ èŠ‚å¥',
                    description: 'å»ºè®®å‡å°‘æ¯æ—¥å­¦ä¹ é‡ï¼Œå¤šèŠ±æ—¶é—´å¤ä¹ å·²å­¦å†…å®¹'
                });
            }
            
            if (streak < 3) {
                suggestions.push({
                    title: 'å»ºç«‹å­¦ä¹ ä¹ æƒ¯',
                    description: 'å°è¯•æ¯å¤©å›ºå®šæ—¶é—´å­¦ä¹ ï¼ŒåŸ¹å…»æŒç»­å­¦ä¹ çš„ä¹ æƒ¯'
                });
            }
            
            if (userStats.totalLearned > 50) {
                suggestions.push({
                    title: 'å°è¯•æ–°çš„å­¦ä¹ æ–¹å¼',
                    description: 'å¯ä»¥å°è¯•æŠ½è®¤å¡æ¨¡å¼æˆ–è®¾å®šæ›´å…·æŒ‘æˆ˜æ€§çš„ç›®æ ‡'
                });
            }
            
            return suggestions.length > 0 ? suggestions : [{
                title: 'ç»§ç»­ä¿æŒ',
                description: 'æ‚¨çš„å­¦ä¹ çŠ¶æ€å¾ˆå¥½ï¼Œç»§ç»­ä¿æŒå½“å‰çš„å­¦ä¹ èŠ‚å¥'
            }];
        }
        
        function analyzeEfficiency() {
            const history = userStats.learningHistory.slice(-20);
            if (history.length === 0) {
                return {
                    accuracy: 0,
                    speed: 0,
                    retention: 0,
                    analysis: 'æš‚æ— è¶³å¤Ÿæ•°æ®è¿›è¡Œåˆ†æ'
                };
            }
            
            const accuracy = Math.round((history.filter(h => h.result === 'correct').length / history.length) * 100);
            const speed = Math.round(history.reduce((sum, h) => sum + (h.responseTime || 3), 0) / history.length * 10) / 10;
            const retention = Math.round(calculateRetentionRate() * 100);
            
            let analysis = '';
            if (accuracy > 85) {
                analysis = 'å­¦ä¹ å‡†ç¡®ç‡å¾ˆé«˜ï¼Œå¯ä»¥é€‚å½“å¢åŠ å­¦ä¹ éš¾åº¦æˆ–æ•°é‡ã€‚';
            } else if (accuracy < 70) {
                analysis = 'å»ºè®®æ”¾æ…¢å­¦ä¹ èŠ‚å¥ï¼Œå¤šèŠ±æ—¶é—´åœ¨å¤ä¹ å’Œå·©å›ºä¸Šã€‚';
            } else {
                analysis = 'å­¦ä¹ çŠ¶æ€è‰¯å¥½ï¼Œä¿æŒå½“å‰èŠ‚å¥ç»§ç»­å­¦ä¹ ã€‚';
            }
            
            return { accuracy, speed, retention, analysis };
        }
        
        function calculateRetentionRate() {
            const learnedData = Object.values(enhancedLearningData).filter(data => data.learned);
            if (learnedData.length === 0) return 0;
            
            return learnedData.reduce((sum, data) => sum + data.masteryLevel, 0) / learnedData.length;
        }
        
        function generateLearningPredictions() {
            const remainingPhrases = allFlattenedPhrases.length - userStats.totalLearned;
            const dailyRate = userStats.dailyTarget;
            const daysToComplete = Math.ceil(remainingPhrases / dailyRate);
            
            const completionDate = new Date();
            completionDate.setDate(completionDate.getDate() + daysToComplete);
            
            return {
                completionTime: `çº¦${daysToComplete}å¤© (${completionDate.toLocaleDateString()})`,
                nextWeekFocus: getNextWeekFocus(),
                trend: getTrendAnalysis()
            };
        }
        
        function getNextWeekFocus() {
            const weakestCategory = findWeakestCategory();
            return weakestCategory ? `é‡ç‚¹å­¦ä¹ "${weakestCategory}"åˆ†ç±»` : 'ç»§ç»­æŒ‰è®¡åˆ’å­¦ä¹ ';
        }
        
        function findWeakestCategory() {
            const categoryStats = {};
            phrasesData.forEach(category => {
                let learned = 0;
                category.phrases.forEach(phrase => {
                    if (learnedPhrases[`GLOBAL_${phrase.en}`]) learned++;
                });
                categoryStats[category.category] = learned / category.phrases.length;
            });
            
            return Object.keys(categoryStats).reduce((a, b) => 
                categoryStats[a] < categoryStats[b] ? a : b, null);
        }
        
        function getTrendAnalysis() {
            if (userStats.consecutiveDays > 7) {
                return 'å­¦ä¹ è¶‹åŠ¿è‰¯å¥½ï¼Œä¿æŒç¨³å®šçš„å­¦ä¹ èŠ‚å¥';
            } else if (userStats.consecutiveDays > 3) {
                return 'å­¦ä¹ ä¹ æƒ¯æ­£åœ¨å½¢æˆï¼Œç»§ç»­åšæŒ';
            } else {
                return 'å»ºè®®å»ºç«‹æ›´ç¨³å®šçš„å­¦ä¹ ä¹ æƒ¯';
            }
        }

        function switchLearningHubTab(tabName) {
            currentLearningHubTab = tabName;

            // éšè—æ‰€æœ‰å†…å®¹
            learningPlanContent.classList.add('hidden');
            reviewPlanContent.classList.add('hidden');
            myProgressContent.classList.add('hidden');
            learningGoalsContent.classList.add('hidden');
            learningInsightsContent.classList.add('hidden');

            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            learningPlanTabButton.classList.remove('active');
            reviewPlanTabButton.classList.remove('active');
            myProgressTabButton.classList.remove('active');
            learningGoalsTabButton.classList.remove('active');
            learningInsightsTabButton.classList.remove('active');

            switch (currentLearningHubTab) {
                case 'learning-plan':
                    learningPlanContent.classList.remove('hidden');
                    learningPlanTabButton.classList.add('active');
                    renderLearningPlan();
                    updateTodayStats();
                    break;
                case 'review-plan':
                    reviewPlanContent.classList.remove('hidden');
                    reviewPlanTabButton.classList.add('active');
                    generateUnlearnedPhrasesForReview();
                    currentReviewSetIndex = 0;
                    renderReviewPlan();
                    break;
                case 'my-progress':
                    myProgressContent.classList.remove('hidden');
                    myProgressTabButton.classList.add('active');
                    updateMyProgress();
                    break;
                case 'learning-goals':
                    learningGoalsContent.classList.remove('hidden');
                    learningGoalsTabButton.classList.add('active');
                    renderLearningGoals();
                    break;
                case 'learning-insights':
                    learningInsightsContent.classList.remove('hidden');
                    learningInsightsTabButton.classList.add('active');
                    renderLearningInsights();
                    break;
            }
        }

        function switchMode(mode) {
            const previousMode = currentMode;
            currentMode = mode;

            // æ·»åŠ æ·¡å‡ºåŠ¨ç”»
            const containers = [phrasesContainer, flashcardContainer, learningHubContainer, categoryButtonsContainer];
            containers.forEach(container => {
                if (!container.classList.contains('hidden')) {
                    container.style.opacity = '0';
                    container.style.transform = 'translateY(20px)';
                }
            });

            setTimeout(() => {
                phrasesContainer.classList.add('hidden');
                flashcardContainer.classList.add('hidden');
                learningHubContainer.classList.add('hidden');
                categoryButtonsContainer.classList.add('hidden');

                categoryIntro.textContent = '';
                updateMainNavigationButtons();

                // é‡ç½®æ ·å¼
                containers.forEach(container => {
                    container.style.opacity = '';
                    container.style.transform = '';
                });

                switch (currentMode) {
                    case 'category-browse':
                        phrasesContainer.classList.remove('hidden');
                        categoryButtonsContainer.classList.remove('hidden');
                        phrasesContainer.classList.add('fade-in');
                        categoryButtonsContainer.classList.add('slide-in-left');
                        renderPhrases();
                        updateActiveCategoryButton();
                        break;
                    case 'flashcard':
                        flashcardContainer.classList.remove('hidden');
                        flashcardContainer.classList.add('slide-in-right');
                        loadFlashcardSet();
                        renderFlashcard();
                        break;
                    case 'learning-hub':
                        learningHubContainer.classList.remove('hidden');
                        learningHubContainer.classList.add('fade-in');
                        switchLearningHubTab(currentLearningHubTab);
                        break;
                }

                // æ¸…é™¤åŠ¨ç”»ç±»
                setTimeout(() => {
                    containers.forEach(container => {
                        container.classList.remove('fade-in', 'slide-in-left', 'slide-in-right');
                    });
                }, 500);
            }, 200);
        }

        function initApp() {
            loadLearnedPhrases();
            initLearningPlan();
            renderCategoryButtons();
            setupLearningModeSelection();
            switchMode('category-browse');
            
            // è®¾ç½®æ–°åŠŸèƒ½çš„äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('auto-plan-button').addEventListener('click', generateSmartPlan);
            document.getElementById('add-goal-button').addEventListener('click', addNewGoal);
            
            // åˆå§‹åŒ–å­¦ä¹ æ¨¡å¼
            const savedMode = userStats.learningMode || 'normal';
            document.querySelector(`input[value="${savedMode}"]`).checked = true;
            updateDailyTargetByMode();
        }


        // Event Listeners for Main Navigation
        categoryBrowseButton.addEventListener('click', () => {
            switchMode('category-browse');
        });

        learningHubButton.addEventListener('click', () => {
            switchMode('learning-hub');
        });

        flashcardModeButton.addEventListener('click', () => {
            switchMode('flashcard');
        });

        // Event Listeners for Learning Hub Sub-navigation
        learningPlanTabButton.addEventListener('click', () => switchLearningHubTab('learning-plan'));
        reviewPlanTabButton.addEventListener('click', () => switchLearningHubTab('review-plan'));
        myProgressTabButton.addEventListener('click', () => switchLearningHubTab('my-progress'));
        learningGoalsTabButton.addEventListener('click', () => switchLearningHubTab('learning-goals'));
        learningInsightsTabButton.addEventListener('click', () => switchLearningHubTab('learning-insights'));


        // Event Listeners for Learning Plan content
        phrasesPerDayInput.addEventListener('change', (event) => {
            let newPhrasesPerDay = parseInt(event.target.value);
            if (isNaN(newPhrasesPerDay) || newPhrasesPerDay < 1) {
                newPhrasesPerDay = 1;
            } else if (newPhrasesPerDay > 15) {
                newPhrasesPerDay = 15;
            }
            phrasesPerDayInput.value = newPhrasesPerDay;
            phrasesPerDay = newPhrasesPerDay;
            currentLearningDay = 0;
            renderLearningPlan();
        });

        prevDayButton.addEventListener('click', () => {
            if (currentLearningDay > 0) {
                currentLearningDay--;
                renderLearningPlan();
            }
        });

        nextDayButton.addEventListener('click', () => {
            const totalDays = Math.ceil(allFlattenedPhrases.length / phrasesPerDay);
            if (currentLearningDay < totalDays - 1) {
                currentLearningDay++;
                renderLearningPlan();
            }
        });

        // Event Listeners for Review Plan content
        refreshReviewButton.addEventListener('click', () => {
            generateUnlearnedPhrasesForReview();
            currentReviewSetIndex = 0;
            renderReviewPlan();
        });
        
        // Event Listeners for Flashcard Mode
        flashcardSourceRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                loadFlashcardSet();
                renderFlashcard();
            });
        });

        shuffleFlashcardsButton.addEventListener('click', () => {
            loadFlashcardSet(); // Re-load and re-shuffle
            renderFlashcard();
        });

        // Simplified Flashcard Navigation and Mark Learned
        prevFlashcardButton.addEventListener('click', () => showPrevFlashcard());
        nextFlashcardButton.addEventListener('click', () => showNextFlashcard());
        markLearnedFlashcardButton.addEventListener('click', () => {
            if (flashcardSet.length === 0) return;
            const currentPhrase = flashcardSet[currentFlashcardIndex];
            const phraseKey = `GLOBAL_${currentPhrase.en}`;
            if (learnedPhrases[phraseKey]) {
                delete learnedPhrases[phraseKey]; // Unmark
            } else {
                learnedPhrases[phraseKey] = true; // Mark
            }
            saveLearnedPhrases();
            updateMarkLearnedFlashcardButtonState(); // Update button text immediately
        });

        // ç§»åŠ¨ç«¯æ‰‹åŠ¿æ”¯æŒ
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }

        function handleTouchEnd(e) {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }

        function handleSwipe() {
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            const minSwipeDistance = 50;

            // ç¡®ä¿æ°´å¹³æ»‘åŠ¨è·ç¦»å¤§äºå‚ç›´æ»‘åŠ¨è·ç¦»
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (currentMode === 'flashcard' && flashcardSet.length > 0) {
                    if (deltaX > 0) {
                        // å‘å³æ»‘åŠ¨ - ä¸Šä¸€å¼ 
                        showPrevFlashcard();
                    } else {
                        // å‘å·¦æ»‘åŠ¨ - ä¸‹ä¸€å¼ 
                        showNextFlashcard();
                    }
                }
            }
        }

        // æ·»åŠ è§¦æ‘¸äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('touchstart', handleTouchStart, { passive: true });
        document.addEventListener('touchend', handleTouchEnd, { passive: true });

        // é˜²æ­¢ç§»åŠ¨ç«¯åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // æ·»åŠ åŠ è½½åŠ¨ç”»
        function showLoadingSpinner(container) {
            container.innerHTML = '<div class="flex justify-center items-center py-20"><div class="loading-spinner"></div></div>';
        }

        // æ·»åŠ æˆåŠŸæç¤º
        function showSuccessMessage(message, duration = 2000) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);

            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, duration);
        }

        // æ·»åŠ é”™è¯¯æç¤º
        function showErrorMessage(message, duration = 3000) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);

            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, duration);
        }

        // ä¼˜åŒ–è¯­éŸ³æ’­æ”¾é”™è¯¯å¤„ç†
        window.addEventListener('error', (e) => {
            if (e.message.includes('speech')) {
                showErrorMessage('è¯­éŸ³æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥è®¾å¤‡éŸ³é‡è®¾ç½®');
            }
        });

        // æ·»åŠ é¡µé¢å¯è§æ€§æ£€æµ‹ï¼Œæš‚åœä¸å¿…è¦çš„åŠ¨ç”»
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // é¡µé¢éšè—æ—¶åœæ­¢è¯­éŸ³
                if ('speechSynthesis' in window) {
                    speechSynthesis.cancel();
                }
            }
        });

        // æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            if (currentMode === 'flashcard' && flashcardSet.length > 0) {
                switch (e.key) {
                    case 'ArrowLeft':
                        e.preventDefault();
                        showPrevFlashcard();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        showNextFlashcard();
                        break;
                    case ' ':
                        e.preventDefault();
                        const flashcard = document.querySelector('.flashcard');
                        if (flashcard) {
                            flashcard.click();
                        }
                        break;
                    case 'Enter':
                        e.preventDefault();
                        const markButton = document.querySelector('#mark-learned-flashcard-button');
                        if (markButton) {
                            markButton.click();
                        }
                        break;
                }
            }
        });

        // Initialize the app
        initApp();

    </script>
</body>
</html>
